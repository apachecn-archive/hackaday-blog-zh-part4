# 本周安全:恶意预览、VNC 漏洞、Powerwall 和第五修正案

> 原文:[https://hack aday . com/2019/11/30/this-week-in-security 恶意-预览-VNC-vulnerabilities-powerwall-and-the-the-5th-amend ment/](https://hackaday.com/2019/11/30/this-week-in-securitymalicious-previews-vnc-vulnerabilities-powerwall-and-the-5th-amendment/)

嵌入 office 文档的恶意软件多年来一直是一种流行的攻击。这些攻击中的许多已经被修复，并且当在受保护的视图中打开文档时，基本上所有当前的攻击都不起作用。有一些方法可以解决这个问题，比如在文档顶部放一个通知，要求用户关闭受保护的视图。[Curtis Brazzell]一直在研究网络钓鱼，以及攻击如何绕过保护视图等缓解措施。他注意到他的一份诱杀文件在打开前打电话给家里。具体怎么做？预览窗格。

Windows 资源管理器界面有一个内置的预览窗格，它有助于支持 Microsoft Office 格式。问题是预览不是使用受保护的视图生成的，至少在预览 Word 文档时是这样。生成预览足以触发远程内容的加载，并可能被用于触发其他漏洞。[Curtis]向微软通报了这个问题，得到的回应有点令人失望。他的发现被官方认为是一个错误，但不是一个漏洞。

### VNC 的弱点

卡巴斯基[的研究人员仔细研究了几个 VNC 实现](https://ics-cert.kaspersky.com/reports/2019/11/22/vnc-vulnerability-research/)，迄今为止发现了总共 37 个 CVE。似乎几个 VNC 项目共享一个相当旧的代码库，它包含了过多的潜在错误。应该像对待 RDP 一样对待 VNC——不要把它暴露在互联网上，也不要连接到未知的服务器。该协议没有考虑到安全性，并且没有一个实现具有足够的安全性。

缺陷的例子包括:在将消息复制到缓冲区后，检查消息是否溢出缓冲区*。另一个代码片段将可变长度的消息读入固定长度的缓冲区，不进行任何长度检查。这个特殊的函数最初是在 90 年代末由 AT & T 实验室编写的，从那以后被复制到多个项目中。*

这里强调了开源的一个潜在缺点。开源使得写得很差的代码得以传播。这不是对开源的抨击，而是对读者的警告。代码或项目使用 OSS 许可证并不意味着它是安全的或高质量的代码。[还有更多漏洞仍在修复过程中](https://github.com/TigerVNC/tigervnc/issues/907)，所以请关注本文的其余部分。

### 强力球

既然我们在谈论安全失败，特斯拉的 Powerwall 就包含了其中的一些。目前还不清楚这些问题中有多少已经通过固件更新得到了解决，但黑客选择[的研究人员刚刚发布了他们的测试结果](https://github.com/hackerschoice/thc-tesla-powerwall2-hack)。

这项工作的亮点是硬编码的 wifi 密码，设置为设备的序列号。问题是序列号是已知格式:`ST<YY><L>0001<XYZ>`。“YY”是制造年份。到目前为止，这只是从 2015 年开始，这意味着只有 5 种可能的选择。“L”是修订版，到目前为止只有 6 只在野外看到。最后 7 位数字似乎是线性递增的数字，只能看到 1000 到 2000 之间的数字。真正有趣的是，wifi 网络名称似乎包含序列号的最后 3 位数字，免费提供这些信息。对于那些在家里跟踪的人来说，这意味着在这种最好的情况下，试图连接到 Powerwall 的 wifi 网络的攻击者只有 30 个可能的密码可以尝试。

对于攻击者来说，进入 Powerwall 的网络会有多糟糕？有一个基于网络的管理界面，使用与 wifi 相同的密码。该接口具有各种有用的功能，如反转功率传感器逻辑。这种选择可能是为了解决一个不幸的电工将传感器夹钳安装反了的问题，但不同的反转组合会导致各种有趣的结果，比如在电池应该充电的时候给电网充电，或者相反地拉电源。另一个有趣的选择是将家庭的电力输出改为另一个国家的标准。加倍电压或改变电源频率可能是灾难性的。

虽然这项研究刚刚发表，但测试的固件似乎来自 2017 年底，此后发布了多个更新。特斯拉还没有在他们的固件版本中公布关于安全修复的细节，所以很难知道这里出现的问题有多少已经被修复。

### 密码、自由和自证其罪

在过去的几年里，一场法律斗争已经在美国慢慢酝酿。核心问题是:宪法保障的反对自证其罪的权利适用于密码吗？法院多年来一直在测试这个问题，但到目前为止，美国最高法院还没有收到任何案例。以前的案例适用了被称为“预先结论例外”的东西。这基本上意味着，有了搜查令，警察可以强迫个人交出已知存在的文件。宾夕法尼亚州最高法院最近对这个问题进行了权衡，发现给出密码的行为本身就是证据，因此受到第五修正案的保护。

> 任何人……在任何刑事案件中不得被强迫做对自己不利的证人……

这是应用计算机革命之前的法律和裁决的困难的又一个例子。如果密码是保险箱的密码，那么通过各种方式打开保险箱就很容易了，甚至不需要个人的合作。现代加密是一个完全不同的领域，没有密码就不可能解密。这一最新裁决否定了上述结论例外适用于密码的观点。这个问题最终可能会由美国最高法院裁决。

因为感恩节，我们将在本周末播出，但请在周五早上关注本周的安全，我们将为您提供这些故事和更多信息。