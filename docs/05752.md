# 卢比孔计划:美国国家安全局秘密出售有缺陷的加密数十年

> 原文:[https://hacka day . com/2020/03/02/project-rubicon-the-NSA-secretly-saled-impaired-encryption-for-decades/](https://hackaday.com/2020/03/02/project-rubicon-the-nsa-secretly-sold-flawed-encryption-for-decades/)

在过去的几年里，有那么几个时刻，阴谋论突然被证明是有事实根据的。曾几何时，有荒谬的说法称美国国家安全局在全国各地的 T4 T 栋大楼里安装了数据窃听装置。就像斯诺登的爆料证实了那些阴谋论一样，二月份[的一则新闻证实了一些关于瑞士加密厂商 Crypto AG](https://www.washingtonpost.com/graphics/2020/world/national-security/cia-crypto-encryption-machines-espionage/) 的理论。

整个故事读起来像是一部冷战时期的间谍惊悚片，就像那些小说中的许多一样，这一切都始于第二次世界大战。作为家族投资的结果，Boris Hagelin 成为 Aktiebolaget 密码公司的掌舵人，该公司后来更名为 Crypto AG (1952)，是一家制造和销售密码机的瑞典公司，与著名的 Enigma 机竞争。战争开始时，哈格林认为瑞典不合适，于是搬到了美国。这是一个偶然的举动，因为它允许哈格林向美国军方销售他公司的 C-38 密码机。该设备被军方命名为 M-209，并成为现场标准加密机。

## 从 M-209 到 PDP-11

![The CX-52](../Images/957ad2c40c798af40ce1a1ffc00a452f.png)

The CX-52, thanks to Rama, Cc-by-sa-2.0-fr

在一个有趣的历史交叉点上，M-209 引起了在贝尔实验室工作的 Unix 先驱 Dennis Ritchie 和 Robert Morris 的兴趣。他们与詹姆斯·里德一起写了一篇关于对密码进行统计分析的论文[，并得出结论，他们的技术可以在几分钟内在 pdp-11 上以近乎完美的准确度破译至少 2500 个字符的未知信息。](https://cryptome.org/2015/12/ReedsTheHagelinCipherBellLabs1978.pdf)

里奇对这件事的书面回忆包括一件相关的轶事。作为准备论文发表的一部分，作者还将其提交给了国家安全局进行审查。1978 年左右，美国国家安全局的一位“退休绅士”拜访了里奇和莫里斯，这给人留下了深刻的印象。

根据里奇的说法:

> …该机构并不特别关心 M-209。他们真正关心的是，Reeds 发现的方法适用于特定政府当前使用的系统，即使很难想象这些人会找到这篇论文并将其与他们自己的操作(使用商业可用的密码机)联系起来…

那次访问的结果是决定无限期推迟出版。尽管看到一些 Unix 英雄出人意料地出现很酷，但这个轶事中最有趣的元素可能是非官方要求不要公布的理由:其他政府正在使用易受此攻击的商业加密机，而 NSA 希望对这些信息保密。

## 与国家安全局的握手

在 M-209 取得成功后，Hagelin 搬回了瑞典，并在那里重新建立了自己的公司，最终将自己和公司搬到了瑞士。美国中央情报局和国家安全局(当时称为 AFSA)密切关注着海格林和 Crypto AG 的活动。一种新的机器正在开发中，CX-52，这让美国的间谍们很担心。

你知道，即使在战争期间，人们也发现 C-38 编码的信息可以在几个小时内被破解。新的 CX-52 极难解密，这意味着 NSA 将失去对全球通信的全方位监控。国家安全局有一个秘密武器，那就是威廉·弗里德曼，他是国家安全局的首席密码学家，也是哈格林的私人朋友。1951 年，在华盛顿特区的宇宙俱乐部，弗里德曼向哈格林提出了一个非正式建议:Crypto AG 将把更新、更安全的机器的销售限制在经过批准的客户名单上，美国将补偿他的销售损失。男人们握了握手，达成了君子协定，然后等待着这个缓慢的过程，使协议正式生效。

政府的车轮确实转得很慢，直到 1955 年 2 月才最终达成协议。除了资金和销售限制，国家安全局还会为改进后的机器制作说明书。有人认为，美国国家安全局制作的手册包括[故意误导的指令](https://www.cryptomuseum.com/manuf/crypto/friedman.htm)，旨在削弱特定用户的加密 AG 机器的加密。

## 构建后门

1967 年，Crypto AG 发布了电子加密机 H-460。这应该代表着加密强度相对于旧的机械模型的又一次巨大飞跃，如果 NSA 不是新系统的主要设计者，它可能会是这样的一次飞跃。他们是如何危及系统安全的？他们似乎操纵了系统核心的随机数发生器，这样在一个已知的时间间隔内,“随机数”会重复出现。批准的客户名单收到了没有受损发电机的设备，但发送到世界其他地方的 H-460 设备具有工厂内置的故意缺陷。当美国国家安全局截获一份用弱化的 H-460 加密的通信时，他们可以在几秒钟内解密，而不是几个月。

![](../Images/0da10aa70296e1362db34c438de5fdf5.png)

1950’s era Crypto AG Device. Image by Cory Doctorow, CC BY-SA 2.0

一个被削弱的随机数生成器听起来熟悉吗？几年前，英特尔处理器中的 RDRAND 指令怎么样？有人认为英特尔芯片中的随机数生成指令是不可信的。Linux 内核开发中有[焰火](https://www.theregister.co.uk/2013/09/10/torvalds_on_rrrand_nsa_gchq/)，但是最终，几个不同的社区开始将 RDRAND 输出视为不可信。

## 买断

尽管并非完全没有冲突，但 NSA 和哈格林之间的协议一直持续到他退休。鲍里斯·哈格林(Boris Hagelin)曾计划将公司传给儿子博·哈格林(Bo Hagelin)，但博于 1970 年死于华盛顿特区的一场车祸。事件发生后不久，Boris Hagelin 辞去了公司的领导职务，并对公司进行了收购。一系列空壳公司被用来掩盖 Crypto AG 新所有者的身份，但最近解密的文件揭示了事情的真相。中央情报局和西德 BND 合资购买了 Crypto AG 公司。从 1970 年到 2018 年，世界各国政府最重要的加密设备提供商之一是这两个情报机构秘密开展的秘密行动。这一行动最终被称为卢比孔河。

Rubicon 的细节被一群记者追踪，还有荷兰的[秘密博物馆](https://www.cryptomuseum.com/index.htm)。这里展示的大部分信息都是从加密博物馆和[华盛顿邮报的故事](https://www.washingtonpost.com/graphics/2020/world/national-security/cia-crypto-encryption-machines-espionage/)中提炼出来的。您可能正在寻找解密的中情局文件的链接，但不幸的是，只有片段可用。来自华盛顿邮报:“邮报能够阅读所有的文件，但材料的来源坚持只刊登摘录。”

一个意想不到的好处是 Crypto AG 是一个有利可图的行业。这项业务的文书工作由 BND 处理，然后他与中央情报局分享利润。这种安排一直持续到 1993 年，当时中央情报局买断了德国在该项目中的参与权。此时，Crypto AG 的财务盈利能力已经消退，但许多政府仍在使用他们的产品。

## Crypto AG 后门程序的真实用途

我们对 Crypto AG 帮助收集的情报有所了解:1978 年，埃及总统来到戴维营谈判和平协议，他的通信使用 Crypto AG 硬件“保护”。1979 年，在伊朗人俘获美国人质后，卡特总统的谈判严重依赖于通过 Crypto AG 硬件获得的情报。

 [https://www.youtube.com/embed/pjYMVSA6xM8?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/pjYMVSA6xM8?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)

T2】

1986 年西柏林一家俱乐部的爆炸案就是一个附带影响的例子。因为这个项目，国家安全局能够最终确定利比亚是爆炸事件的幕后黑手。在披露美国对轰炸协调的了解时，这一决定是精确的，暗示了国家安全局能力的性质。

## 泄露信息

正如你可能想象的那样，要将国家安全局参与 Crypto AG 的事情完全保密是不可能的。例如，Peter Frutiger 是该公司的一名工程师，他发现 Crypto AG 产品有问题。他去了一趟叙利亚解决投诉问题，并着手修复他在那里发现的易受攻击的设备。Crypto AG 首席执行官在 Frutiger 的漏洞被发现后，立即解雇了他。

孟吉亚·卡弗利施是另一个雇员，她聪明反被聪明误，让她看不见的上司日子不好过。她和公司的其他研究人员一起发现了 Crypto AG 产品的一些弱点，并试图提高它们的安全性。

作为对公司工程师工作表现太出色的回应，中情局开始寻找一个人来控制工程师。他们选定了瑞典大学的数学教授杰尔-奥维德曼。更重要的是，维德曼是一个著名的密码学家，他同情美国。他在 1979 年的招募相当简单，威德曼在 1994 年之前一直是中情局的人。作为一个有点名气的密码专家，他的话在公司里成了法律，让公司的其他人遵守规则。维德曼帮助开发了下一代折衷算法，旨在找出统计分析中不会出现的缺陷，但可以很容易地解释为人为错误。他得到的比他预想的要多，因为 Widman 是 1982 年前往阿根廷解释加密 AG 设备中的漏洞的代表之一。策略奏效了——脆弱的算法被更先进但仍然脆弱的密码所取代，阿根廷仍然是 Crypto AG 的客户。

Crypto AG 和客户之间的紧张关系在 1992 年达到顶点。十年来，伊朗的通信一直很脆弱，伊朗慢慢变得聪明起来。加密公司的销售代表 Hans Buehler 在德黑兰被拘留，并被询问有关公司产品的情况。唯一的问题？据 Buehler 所知，他的公司是合法的。九个月过去了，而中央情报局和德国 BND 争论该怎么办。美国的政策是永远不支付赎金，所以中情局不愿意参与保释布勒。最后，德国情报机构选择提供赎金，并确保布勒获释。这一事件被证明是结束中央情报局和 BND 的伙伴关系的开始。1994 年，中情局买断了 BND 对 Crypto AG 的所有权。

## 故事的结局？

解密信息大约在这个时代枯竭。多亏了 1995 年[的新闻报道](https://threader.app/thread/1227240407634993152)和 2014 年[发布的弗里德曼档案](https://www.cryptomuseum.com/manuf/crypto/friedman.htm)，这个故事的一部分已经为人所知。2018 年出售剩余的 Crypto AG 资产似乎已经结束了中情局与该公司的关系。CyOne 和 Crypto International AG 这两家公司是在 Crypto AG 的废墟上创建的。虽然看起来这两家新公司都没有受到攻击，但是它们的产品可能仍然包含受到攻击的加密技术，因此仍然应该被认为是不可信的。

目前还不清楚是否有任何政府仍在使用中情局时代的 Crypto AG 硬件进行通信，但政府的惰性和繁文缛节会让人认为这些产品仍在某个地方使用。除了这种可能性，我们不得不怀疑其他专有加密产品是否也受到了类似的威胁。甚至可以想象，开源加密产品被巧妙地设计成易受攻击的。

卢比孔行动被中央情报局认为是“世纪情报政变”，不难理解为什么。留给我们的问题是，21 世纪的智能政变会是什么样子，我们会看到它的到来，还是几年后才知道。