# 本周安全:Windows 上的文本渲染、GNU Poke 和域名抢注

> 原文：<https://hackaday.com/2021/03/05/this-week-in-security-text-rendering-on-windows-gnu-poke-and-bitsquatting/>

Project Zero 只是不限制[CVE-2021-24093](https://bugs.chromium.org/p/project-zero/issues/detail?id=2123)的细节，这是 Windows 10 的 DirectWrite(一个文本渲染库)中一个潜在的严重漏洞。该漏洞在本月的补丁周二综述中得到修复。Windows 10 上的所有主要浏览器都可以访问该漏洞，因为它们使用 DirectWrite 进行字体渲染。这里的技巧是使用恶意字体，使用一些无意义的值。这些值导致缓冲区分配对于复杂字符(如`Æ`)来说太小。

因为该漏洞是一个 Windows 库，所以有可能一个漏洞会自动作为一个沙盒逃脱，但我还没有看到任何方式的确认。如果你有什么见解，请告诉我们。

[通过哔哔声计算机](https://www.bleepingcomputer.com/news/security/google-shares-poc-exploit-for-critical-windows-10-graphics-rce-bug/)

## GNU 戳

GNU 的好人们[创造了`poke`的 1.0 版本](https://savannah.gnu.org/forum/forum.php?forum_id=9949)，一个新的二进制编辑工具。poke 真正的杀手锏是它可以解释二进制数据，将其解码回可读的数据结构。如果您熟悉 Wireshark 解码数据包并给出有用的、有组织的输出的方式，似乎`poke`将提供类似的功能，但不限于网络流量。

看起来它可能会成为一个有用的工具，让我们深入了解原本不透明的二进制文件。`poke`带来的是一个系统，在这个系统中你可以动态地编写漂亮的打印模板，这在绘制一个不熟悉的二进制文件时会非常有用。发行版可能会在未来几周开始打包 poke，让它更容易获得和使用。

## 合法的恶意软件制造者？

对于 NSO 集团来说，这些小鸡可能会得到报应。快速回顾一下，NSO 制造复杂的间谍软件。NSO 制作了针对全球 Whatsapp 用户的恶意软件。NSO 认为，他们只是制造工具，并合法地出售给政府，而不能对政府用这些工具做什么负责。好吧，美国司法部不相信，并已慢慢地对 NSO 的案件。

该案件有可能成为一个重要的案件，因为它将为恶意软件制造商是否对该恶意软件的使用方式负责创造先例。一些非常大的名字，像谷歌和微软，已经对潜在的起诉表示支持。他们的立场是，给予间谍软件制造者豁免权将导致每个人的安全性降低。我真的很想知道，对于一个发布漏洞概念证明的安全研究人员来说，这样的裁决意味着什么。如果恶意软件活动继续改编和使用研究代码，这是一种责任吗？

## 思科漏洞

思科最近刚刚发布了一系列补丁和漏洞，其中一些非常严重。首先是 [CVE-2021-1393](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-case-mvuln-dYrDPC6w) ，思科应用服务引擎中的一个 bug。该漏洞被描述为对特定服务的“访问控制不足”。未经验证的攻击者可以通过 TCP 连接到服务，并更改系统。描述非常模糊，但这可能是类似于生产中意外启用的调试端口。一个非常令人厌倦和愤世嫉俗的猜测是，他们只是让 telnet 端口大开着。

接下来是 [CVE-2021-1388](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-mso-authbyp-bb5GmBQv) ，思科的 ACI 多站点编制器中的一个类似的 bug。在这种情况下，它是一个可以被骗来提供管理员令牌的 API。一旦拥有了这个令牌，用户就可以作为管理员访问整个 API，完全不需要登录。

最后， [CVE-2021-1361](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-3000-9000-fileaction-QtLzDRy2) 是一个文件系统管理服务，它无意中在端口 9075 上暴露给了外部网络。该服务中的漏洞意味着攻击者可以创建、删除或修改任意文件。

## 交换 0 天

[Microsoft Exchange 刚刚修补了一组由于主动利用而被发现的漏洞](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)。微软将攻击归咎于铪，一个被认为受雇于中国政府的组织。

Volexity 似乎是第一个发现攻击的公司。他们为各种客户提供网络监控服务，该服务在两个独立的客户网络上检测到大量数据泄漏。在追踪到异常流量后，他们发现了受损的 Exchange 服务器，并能够确定用于损害机器的 0 天。

## 施乐复印（法）

如果你碰巧发现施乐公司的某个产品存在漏洞，适当的反应显然是在网上匿名发布，因为施乐公司会给你发一个停止命令。[raphal Rigo]原定于 2 月 18 日就施乐打印机的一系列漏洞发表演讲，作为渗透安全会议的一部分。讲座预定的那一天，由于施乐公司的法律威胁，渗透宣布取消。这些漏洞早在 2020 年就被披露给了施乐，所以他们并不是没有足够的时间来修复这些问题。

## 域名抢注

宇宙射线被归咎于偶尔的计算机问题。该理论认为，宇宙射线可以击中一个存储位置，并实际上导致个别位翻转。我不知道宇宙射线是否总是罪魁祸首，但我知道 RAM 问题相当普遍，会导致难以解决的问题。我们已经讨论了 Rowhammer 和相关的攻击，在这些攻击中，操作某些 ram 位会导致物理上邻近的位发生变化。其中一个关于无意比特翻转的安全谈话表明，世界上的计算机每天看到大约 600，000 次误翻转。

现在，域名抢注本质上是一种域名抢注。域名抢注是指选择一个人们可能会不小心打错的名字，比如“goggle.com”。域名抢注是选择可能通过比特翻转到达的名称。我是通过[雷米]的工作了解到这个想法的，他决定最终[使用 windows.com 域名](https://remyhax.xyz/posts/bitsquatting-windows/)测试域名抢注理论。我将使用他的研究来演示这是如何工作的。字符串“windows”翻译成二进制为`01110111 01101001 01101110 01100100 01101111 01110111 01110011`。一个比特翻转就能把第二个字符从“I”的“T1”变成“h”的“T2”。突然你的电脑在寻找“whndows.com”进行更新，或者获取当前时间等。

打算用于 windows 域的连接有多长时间会出现在被占用的域中？[remy]计算出有 32 个这样的有效域名，并且能够购买其中的 14 个——不到一半。他设置了通配符 DNS，以便“*.whndows.com”也能解析到他监听流量的 IP 地址。在两周内，他的 14 个域名收到了 199，180 个 NTP 请求。这些来自 626 个分散的地址。

有一件事特别有趣。一台使用中文 IP 地址的计算机向`time.wiodows.com`发出了一个 HTTP 请求，这可能是人为的错误，因为这实际上不是 NTP 请求。奇怪的是，在这个请求发出后不久，百度搜索蜘蛛又向同一个虚假域名发出了第二个请求。[雷米]觉得很奇怪，但我相信我知道这是什么。众所周知,“中国防火长城”可以检测到未知域名的 HTTP 连接，然后建立自己的连接，抓取新网站的内容。这种意想不到的联系几乎肯定是 GFW 的探测。

[一个早期的实验](http://dinaburg.org/bitsquatting.html)在一组不同的域名抢注上运行了更长时间。在这种情况下，[Artem Dinaburg]观察这些域名仅 7 个多月，平均每天有 59 个不同的 IP 地址试图连接到虚假的域名。他指出，其中一些联系可能是打字错误，而不是比特转换。另一个观察结果是，他发现移动设备在与他的域名抢注的联系中所占比例过高。对此我能想到两种可能的解释。首先，移动设备可能更容易发生比特翻转，这可能是因为它们在户外使用得太频繁了。或者，我怀疑手机屏幕键盘更容易打字。无论如何，域名抢注是一项非常聪明的技术，确实对现实世界产生了影响。