# 本周安全:SWAPGS、恶意着色器、更多 IOS 灾难和 WPA3

> 原文:[https://hack aday . com/2019/08/09/this-week-in-security-swapgs-malicious-shaders-more-IOs-disease-and-wpa 3/](https://hackaday.com/2019/08/09/this-week-in-security-swapgs-malicious-shaders-more-ios-woes-and-wpa3/)

我相信你已经听说过 [Spectre](https://hackaday.com/2018/01/05/lets-talk-intel-meltdown-and-spectre/) ，这是现代处理器中发现的许多推测性执行漏洞中的第一个。这周刚出了一个新的。在周二的 Blackhat，CVE-2019-1125 被 Bitdefender 宣布为 [SWAPGS](https://www.bitdefender.com/business/swapgs-attack.html) 。

SWAPGS 是一条 x86_64 指令，用于上下文切换，即执行从用户空间程序转移回内核。具体来说，SWAPGS 交换 GS 寄存器的值，使其指向正在运行的应用程序中的一个内存位置，或者内核空间中的一个位置。一个无特权的程序可以试图调用该指令，并由于处理器推测性地执行该指令而泄漏内核内存内容(这与 Spectre 类似)。即使该指令最终不会被执行，因为用户空间程序没有足够的特权来执行，但是系统缓存的内容已经被充分地改变了，攻击者可以利用这一点来读取任意内核内存。

虽然最初的报告提到了 AMD 和英特尔的产品，但 AMD 发布了一份[声明](https://www.amd.com/en/corporate/product-security):

> AMD 知道新的研究声称新的推测性执行攻击可能允许访问特权内核数据。基于外部和内部分析，AMD 认为它不容易受到 SWAPGS 变体攻击，因为 AMD 产品的设计不会在投机性 SWAPGS 之后推测新的 GS 值。对于不是 SWAPGS 变体的攻击，缓解措施是实施我们对 Spectre 变体 1 的现有建议。

Windows 和 Linux 的补丁已经发布，Red Hat 有一篇关于该漏洞的信息性文章[。我本想回顾一下 Bitdefender 关于该漏洞的白皮书，但他们选择要求提供姓名和电子邮件地址，而不是免费提供。虽然我希望看到他们的作品，但我拒绝出售我的联系信息来换取访问权。](https://access.redhat.com/articles/4329821)

## 恶意着色器？

这是我第一次听说恶意像素着色器。思科 Talos 宣布了一组针对 VMware 和 NVIDIA 显卡驱动程序的[漏洞](https://blog.talosintelligence.com/2019/08/nvidia-vmware-gpu-rce-vulnerabilities.html)。

着色器是在视频卡上运行的专用程序，通常用于应用模糊、照明、凹凸贴图等效果。过去几年游戏中的大多数图形改进都是着色器的结果。

Talos 研究人员专门研究如何从客户操作系统内部破坏虚拟机管理程序，他们发现当主机向客户提供 3d 加速时，着色器会直接传递到系统驱动程序，而无需验证。因为 NVIDIA 驱动程序也容易受到攻击，这可能允许主机上的恶意程序在虚拟机管理程序上运行任意代码。

虽然这已经够麻烦的了，但最大的问题是恶意着色器可能会通过 WebGL 运行。总之，这代表了一个真正的危险，简单地加载一个恶意的启用 WebGL 的页面不仅会危及传统机器的安全，还会危及裸机操作系统的安全，即使是在来宾实例上运行。

NVIDIA 和 VMware 都已经发布了修复该缺陷的驱动程序更新，所以请更新！

## iOS 问题

谷歌零计划的娜塔莉·席尔瓦诺维奇在 7 日星期三发布了一组 5 个 iOS 漏洞。这些不是普通的 bug，而是所谓的“零点击”问题，在这种情况下，利用漏洞不需要用户交互。

例如，第一个漏洞是伪造的可视语音邮件消息。可视语音邮件通知作为特殊格式的文本消息发送，包含有关消息的信息以及用于连接和下载消息的 IMAP 服务器的地址。这些信息可能是伪造的，导致设备试图从攻击者控制的 IMAP 服务器下载邮件。从这一点来看，在 iOS IMAP 处理代码中找到一个 bug 是相对容易的。

iOS 更新中修复了 5 个漏洞。还有第六个漏洞，CVE-2019-8641，尚未修复。虽然给出了一些关于此问题的提示，但在发布更新以完全修复该问题之前，不会公布详细信息。有人可能有点愤世嫉俗，指出这是谷歌研究团队宣布这些缺陷。虽然肯定有自私的角度要考虑，但如果缺陷得到修复并公开，而不是保密并出售给进攻性的安全供应商，对 iOS 和消费者来说会好得多。

另一个 iOS 故事是 [Apple Bleee](https://hexway.io/blog/apple-bleee/) 。蓝牙低能耗是一种非常有用的通信协议，允许苹果设备执行许多看似神奇的功能。不利的一面是，为了让奇迹发生，iOS 设备不断发送 BLE 信号，探测其他设备。Hexway 的研究人员意识到，这些信号泄露了你的设备的大量数据，可能包括你的电话号码。

使用隔空投送时，iOS 使用设备电话号码的 SHA256 哈希作为标识符。SHA256 仍然是相当安全的单向散列，所以没有问题，对吗？巧妙的实现是，虽然散列是安全的，并且输出空间太大而无法攻击，但是输入空间足够小而易于管理。攻击者可以锁定他们所在区域最常见的区号，进一步限制目标空间。从那里，所有有效数字的 SHA256 散列可以预先计算并存储在查找表中。

## 更多 WPA3 问题

我们已经讨论了 WPA3 分析项目 [Dragonblood](https://hackaday.com/2019/04/19/shadowhammer-wpa3-and-alexa-is-listening-this-week-in-computer-security/) 。一个新的问题被发现，[一个定时分析攻击](https://wpa3.mathyvanhoef.com/#new)泄露了关于加密算法内部状态的信息。