# 没有 ARM 打印机驱动？写你自己的就行了

> 原文:[https://hack aday . com/2022/02/06/no-arm-printer-driver-just-write-your-own/](https://hackaday.com/2022/02/06/no-arm-printer-driver-just-write-your-own/)

当你想到在包装上打印粘性标签的小型机器时，你可能不会想到会找到一台拥有自己编程语言的复杂打印机(ZPL)。然而，[丹·帕斯图塞克]在网上四处寻找，在每个人都喜欢的网上仓库里发现了一个小标签打印机，价格很高，表明它支持 ZPL。不幸的是，[Dan]有着创建基于 Raspberry Pi 的打印站的远大梦想，却发现为这种特殊打印机打包的驱动程序与 ARM 不兼容。他并不满足于就此罢休，他开始一层层地凿下去，直到他有了一个可用的驱动程序。

ZPL 的核心就是一种描述通过串行连接传输的 ASCII 命令的语言。因此，虽然打印机显示为端点，但它并不工作，因为过滤器(知道如何从 PNG 转换为 ZPL 的驱动程序的一部分)只是 x86。在 Linux 上，打印机驱动程序也有一个 PPD 文件，它描述了打印机可以处理的纸张大小和其他设置。小打印机的 PPD 文件给出了第一条线索。在 ShortNickName 字段中，它将自己标识为 HPRT N41，这是一款流行的惠普打印机。所以这台小打印机肯定是那家打印机的克隆品。值得注意的是，他们不支持 ZPL。相反，HPRT 系列支持 TSPL，另一种由 TSC 开发的打印机语言。

这带来了一个问题，因为提供[丹]使用的标签的运输服务提供三种格式的标签:PNG、PDF 和 ZPL。目前，看起来确实有一个 TSPL 到 ZPL 的转换器可供使用，所以他没有自己写，而是走了一条捷径，写了一个光栅化器。最初，他试图使用他找到的一些样本代码，当他从打印机中得到一些东西时，它是空白的。因此，下一个测试是将来自文件管理器的原始 TSPL 输出直接保存到串行端口。这非常有效。接下来，[他编写了一个转换器](https://github.com/kubesail/raster-to-tspl-js/blob/main/print.js)来获取一个 PNG 并将它们转换成 TSPL 的位图格式。转换器是 Javascript 格式的，因为它作为管理打印站的网络服务器的一部分运行。用另一种语言会更快吗？当然可以。但是不同的语言不会让打印机更快。

随着无线条形码扫描仪的添加，看到打印站启动并运行令人满意。在 Hackaday，我们对看到人们拆开打印机来剥离组成它们的软件和物理层并不陌生。