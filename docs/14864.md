# 特洛伊木马可以潜伏在 AVR 引导程序中

> 原文:[https://hack aday . com/2022/09/21/trojans-can-luky-inside-AVR-boot loaders/](https://hackaday.com/2022/09/21/trojans-can-lurk-inside-avr-bootloaders/)

如果说这些年来我们学到了什么的话，那就是如果它里面有一个硅片，它可能携带了病毒。一个小组的研究集中于在 AVR Arduino 引导程序中隐藏木马，[证明甚至我们的小业余爱好者微控制器也不安全](https://01001000.xyz/2021-04-21-Hiding-a-Trojan-in-an-AVR-Arduino-Bootloader/)。

该研究的具体目标是将木马隐藏在 AVR 芯片本身的引导加载程序中。这将允许特洛伊木马保留在类似 3D 打印机的设备上，即使重新安装了主固件。特洛伊木马仍然能够从其卑鄙的藏身之处对打印机的性能产生影响，但将更难被发现和删除。

这项工作的目标是 ATmega328P，通常用于 3D 打印机，特别是那些使用 Marlin 固件的打印机。对于完整的技术细节，你可以一头扎进去[亲自阅读研究论文](https://arxiv.org/abs/2104.09562)。不过，从根本上来说，修改后的引导程序能够使用芯片的 IVSEL 寄存器来允许引导程序在通过中断引导后执行。当一个中断被调用时，执行传递到被木马感染的引导程序的特殊代码，然后返回到程序自己的中断以避免引起怀疑。木马也可以在程序的中断代码之后执行，增加了攻击的灵活性。

简单地将程序刷新到受影响的芯片上并不能清除木马。取而代之的是，芯片必须让它的引导装载程序专门重写一个干净的版本，以删除有问题的代码。

总的来说，这不是一个超级危险的攻击。通常，刷新恶意引导加载程序需要物理接触芯片。此外，把代码偷偷放到普通的 3D 打印机上不会有什么好处。然而，这仍然是一个很好的例子，说明了引导加载程序真正能做什么，也提醒了我们在有安全意识的领域中操作时应该小心什么。在外面注意安全！