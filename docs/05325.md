# 本周安全:ToTok，Edgium，Chrome 检查你的密码，等等

> 原文:[https://hackaday . com/2020/01/03/this-week-in-security-totok-EDG ium-chrome-checks-your-passwords-and-more/](https://hackaday.com/2020/01/03/this-week-in-security-totok-edgium-chrome-checks-your-passwords-and-more/)

圣诞快乐，新年快乐！休假一周后，我们有很多故事要报道，首先是来自苹果的一份意想不到的圣诞礼物。苹果公司多年来一直在开展一项仅限受邀者的 bug 奖励计划，但它只覆盖 iOS 系统，最高奖金高达 20 万美元。新计划对公众开放，覆盖整个苹果产品阵容，最高支付额为 150 万美元。继续寻找漏洞，并确保让我们知道你找到了什么。

### ToTok

阿拉伯联合酋长国对 VoIP 通信有一个奇怪的政策。至少在移动网络上，似乎所有的网络电话都被屏蔽了——除非你用的是一个特殊的应用程序:ToTok。这听起来奇怪吗？你的“安全蜘蛛感”刺痛了吗？或许应该。《纽约时报》报道了 ToTok，声称它实际上是一个监视公民的工具。

虽然这一报道很有趣，但在[帕特里克·沃德尔]对应用程序的[研究中可以找到更多内容。然而，最值得注意的是，该应用程序本身明显缺乏证据。当然，ToTok 可以读取你的文件，将你的通讯录上传到中央服务器，并尝试发送设备的 GPS 坐标。打着方便的旗号，这和其他应用程序已经做的并没有太大的区别。](https://objective-see.com/blog/blog_0x52.html)

ToTok 似乎缺乏端到端的加密，这意味着无论谁是该应用的幕后黑手，都可以很容易地解密通话。由于应用程序本身没有恶意代码，因此很难称其为间谍工具，但很难想象有更好的方法来捕获 VoIP 呼叫。自这些文章发表以来，tototok 已经从苹果和谷歌的应用商店中被移除。

### 通往王国的短信钥匙

您是否注意到有多少服务将您的手机号码视为一种积极的身份验证方式？需要重设密码吗？只需输入短信中发送的六位数代码。证明是你？我们给你发了一条短信。[Joakim Bech]发现了一个更进一步的弱点:他只需要一条短信，就可以从任何地方控制你的防盗报警器。嗯，至少如果你有瑞典警报系统的安全系统。

控制消息是通过 SMS 发送的，这使得它们很容易被攻击者获取。AES 加密用于加密，但一系列错误严重降低了该加密的有效性。第一个是关键。为了构建 128 位加密密钥，该应用程序采用用户的四位数 PIN，并用零填充，因此它本质上是一个 13 位加密密钥。更糟糕的是，系统中根本没有内置消息认证。攻击者只需一条捕获的 SMS 消息就可以暴力破解用户的 PIN，修改消息，并轻松发送被视为有效的欺骗命令。

### 微软浏览器

你可能已经看到新闻了，微软正在放弃他们的 Edge 浏览器代码，并将很快开始发布基于 Chromium 的 Edge。虽然这本身就是一种娱乐，但一些人已经开始利用 Chromium Edge (Edgium？).这是一个奇怪的奖励计划，因为微软没有兴趣为在谷歌代码中发现的错误付费。因此，只有 Edge 专有功能中的错误才有资格获得微软的赔偿。

正如阿卜杜勒拉赫曼·卡班迪所说，这是一个非常小的攻击面。即便如此，[他还是设法找到了一个符合](https://leucosite.com/Edge-Chromium-EoP-RCE/)的漏洞，这是独一无二的。微软对 Edgium 的一个补充是一个定制的新标签页。与其他浏览器类似，新标签页向用户显示他们最常访问的网站。问题是网站的标题显示在页面上，但没有任何健全的检查。如果您站点的标题字段碰巧包含 Javascript，那么它也会被注入到新的选项卡页面中。

完整的利用有几个额外的步骤，但本质是一旦网站进入新的标签页，它就可以接管该页，甚至可能逃离浏览器沙箱。

### Chrome 密码检查

这个故事有点老了，但确实吸引了我的注意力。谷歌在 Chrome 中推出了一项功能，可以自动将你保存的密码与过去的数据泄露进行比较。这是如何做到不成为安全噩梦的呢？很聪明。每个用户名的三字节散列被发送到 Google，并与被入侵帐户的散列进行比较。潜在匹配的加密数据库将发送到您的机器。你保存的密码，已经用你的密钥加密，用谷歌密钥第二次加密，和可能匹配的数据库一起发送回来，也用同样的谷歌密钥加密。巧妙之处在于，一旦你的机器解密了你的数据库，它现在就有了两套凭证，都用同一个 Google key 加密。由于这种加密是确定性的，因此加密的数据可以在不解密的情况下进行比较。最终，你的密码不会暴露给谷歌，谷歌也不会泄露他们的数据集。

### 密码队列

密码更改很痛苦，但通常不会这么痛苦。德国的一所大学遭受了严重的恶意软件感染，[采取了预防措施，重置了每个学生账户](https://www.zdnet.com/article/more-than-38000-people-will-stand-in-line-this-week-to-get-a-new-password/)的密码。他们引导密码更改的解决方案？学生们必须亲自带着有效身份证件到办公室领取新密码。该校引用德国法律要求作为奇怪解决方案的主要原因。尽管如此，对于安全的交付方式来说，这是无与伦比的。