# 本周在安全:广告已经下降，两个因素的缺陷，黑客政治家

> 原文:[https://hack aday . com/2020/09/18/this-week-in-security-ad-has-fall-two-factor-flaws-and-hacking-politics/](https://hackaday.com/2020/09/18/this-week-in-security-ad-has-fallen-two-factor-flaws-and-hacking-politicians/)

本周的大新闻是微软活动目录的巨大缺陷， [CVE-2020-1472](https://www.secura.com/blog/zero-logon) ( [白皮书](https://www.secura.com/pathtoimg.php?id=2055))。Netlogon 是 Windows 域方案的一部分，用于在不通过网络发送密码的情况下对用户进行身份验证。现代版本的 Windows 使用 AES-CFB8 作为支持 Netlogon 身份验证的加密引擎。AES 的这种特殊模式需要一个初始化向量(IV)以及密钥和明文。这里的缺点是微软的实现将 IV 设置为全零。

![](../Images/2d1acc3df7386ad0319dde4b8b69b7d2.png)

XKCD.com CC BY-NC 2.5

有必要花点时间来解释一下为什么 IVs 存在，以及为什么它们很重要。基本 AES 加密过程有两个输入:128 位(16 字节)明文和 128、192 或 256 位密钥。相同的明文和密钥每次都会导致相同的密文输出。用这种幼稚的方法加密超过 128 位的数据会很快暴露出一个问题——有可能在输出中发现模式。更糟糕的是，对这些模式的巧妙研究可以构建一本解码书。最常出现的 16 字节模式将首先被猜测。这就像一个巨大的填字游戏，试图填补空白。

这个问题比 AES 早很多年，谢天谢地，一个好的解决方案也已经存在很长时间了。密码块链接(CBC)获取每个块的密文输出，并在加密前将其与下一个块的明文输入混合(XOR)。这种技术确保即使明文相同，输出块也不会相关。缺点是如果丢失一个块，~~剩下的整个数据都无法解密~~更新:[dondarioutade]在评论中指出，丢失的只是下一个块，而不是整个流。你可能会问，对于第一个块来说，明文中混合了什么？没有前一个块可供提取，那么使用什么数据来初始化流程呢？是的，这个名字泄露了一切。这是一个初始化向量:用于建立加密方案初始状态的数据。一般来说，静脉注射不是秘密的，但应该是随机的。在 CBC 的情况下，像全零这样的非随机 IV 值不会完全破坏加密方案，但可能会导致弱点。

另一方面，Netlogon 使用 AES 的密码反馈(CFB8)模式。这种模式采用 16 字节的 IV，并将该值添加到要加密的数据中。该消息的前 16 个字节(仅 IV 字节)执行基本的 AES 运算。输出的第一个字节与组合字符串的第 17 个字节进行异或运算，然后 16 字节窗口向右滑动一个字节。当明文消息的最后一个字节被异或时，IV 被丢弃，过程结束。AES-CFB8 的特殊结构意味着随机 IV 对于强加密更为重要。

还记得实际的瑕疵吗？微软的实现将 IV 值设置为全零。加密密钥由密码生成，但要加密的明文可以由攻击者指定。操纵这种情况非常简单，整个 IV +明文字符串由零组成。在这种状态下，256 个密钥中有 1 个会产生全零密文。换句话说，AES 的 128 位安全性降低到了 8 位。只需几次猜测，攻击者就可以使用 Netlogon 作为任何用户进行身份验证。

微软已经在 8 月的安全更新中修补了该问题。虽然利用这个问题确实需要在网络中有一个立足点，但是利用起来很简单，并且已经有了概念代码的证明。这绝对是一个需要马上修补的问题。

[通过 Ars Technica](https://arstechnica.com/information-technology/2020/09/new-windows-exploit-lets-you-instantly-become-admin-have-you-patched/)

### 当 2FA 让你变得不安全

很少有安全常识像“启用双因素身份验证”这样普遍这里有一个小问题。2FA 增加了一个额外的攻击面。帕洛阿尔托通过他们的泛操作系统艰难地发现了这一点。如果启用 2FA 或强制网络门户，就有可能利用缓冲区溢出并以根用户身份执行代码。由于被利用的接口经常暴露在公众面前，因此该漏洞的关键评级为 9.8。

### 虚拟卡片分离器

Magento 是一个电子商务平台，自 2018 年以来归 Adobe 所有。更简单地说，这是一个网站的购物车系统。在过去的几天里，[近 2000 个 Magento v1 实例被入侵](https://sansec.io/research/largest-magento-hack-to-date)，这些站点上安装了一个数字分离器。这种快速利用表明有人拥有 Magento 驱动的网站数据库，并获得了可以自动化的零日利用。

### 为了乐趣和利益而黑政客

多年来，谈论黑客选举，尤其是北亚一个特别大的国家的黑客选举，一直是专家和政治家的话题。不管是勇敢还是愚蠢，我们实际上要简单看看一些政治黑客的真实故事。

首先，三名荷兰黑客在 2016 年大选前成功侵入唐纳德·特朗普的推特账户。怎么会？同样的故事我们都很熟悉:密码重用和 LinkedIn 数据库转储。有趣的是，唐纳德·特朗普最喜欢的密码是“yourefired”。

一次成功的闯入往往伴随着一瞬间的恐怖。“我做的每件事都是对的吗，还是我要为此坐牢？”这不是毫无根据的恐惧。闯入一家公司是一回事，但是黑了美国总统的那些家伙会怎么样呢？当他们的长期尝试得到回报时，他们进入了防御模式，并记录了一切。一旦他们的文件得到安全保护，一封电子邮件被发送到 USCERT(美国计算机应急准备小组),通知他们发现了什么。我们的荷兰朋友没有被逮捕或“失踪”，所以他们负责任的披露似乎受到了好评。

在一个类似的故事中，一位澳大利亚前总理在网上发布了一张包含他的登机牌的照片，一位足智多谋的研究员成功利用这些信息找到了他的护照和电话号码。你知道登机牌被视为敏感信息吗？要向航空公司认证，只需要一个姓氏和匹配的预订参考号。这让你访问一个非常无趣的页面，但当你访问 1337 hackor 工具(如谷歌 Chrome 的页面检查器)时，天空就是极限。很明显，澳航网站后台正在发送数据库中关于给定客户的所有信息，而只有少量信息显示给用户。更多的信息正等着被发现。

整个故事就像一次旅行，以一个与相关政客的电话结束。去读吧，你不会后悔的。

### 零日？

Neal Krawetz 博士]经营着一个 TOR 隐藏服务，他发现自己是 TOR 网络上 DDoS 攻击的受害者。他打电话给一个专业做网络安全的朋友，寻求帮助。在读出主机服务器所在的公共 IP 地址的一半后，[他的朋友告诉他剩下的地址](https://www.hackerfactor.com/blog/index.php?/archives/896-Tor-0day-Finding-IP-Addresses.html)。让我们仔细想想这个过程。隐藏的 TOR 服务受到攻击时，能够访问足够大的网络操作中心(NOC)的人可以知道该服务的公共 IP 地址是什么。这是 TOR 目的的根本突破。

回过头来看，很明显，如果你能观察到互联网上的大量流量，或者足够多的 TOR 节点，你就能知道什么服务在哪里运行。令人惊讶的是，这个比例需要有多小，而且已经有公司(当然还有三个字母的机构)有能力随便建立这些联系。[Krawetz]将这些缺陷称为 0 天，这在技术上是正确的，因为没有真正的缓解措施来防范它们。事实上，它应该提醒我们 TOR 模型的局限性。