# 剧透，免费后使用，和 Ghidra:本周在计算机安全

> 原文:[https://hack aday . com/2019/03/13/spoiler-use-after-free-and-ghidra-this-week-in-computer-security/](https://hackaday.com/2019/03/13/spoiler-use-after-free-and-ghidra-this-week-in-computer-security/)

如果你想跟上计算机安全新闻的步伐，过去几天会很忙。在 Windows 7 系统上被积极利用的严重 Chromium 漏洞、美国国家安全局作为开源项目发布的一个工具，以及英特尔处理器中新的类似 Spectre 的投机性执行缺陷之间，有很多东西需要消化。

## 英特尔的搅局者

为了讨论“剧透”，让我们快速回顾一下我们是如何走到这一步的。推测性执行是现代处理器的一个主要特点，允许代码无序执行，并在需要时缓存结果。随着时钟速度在 5 GHz 的关口停滞不前，每周期指令数(IPC)已经成为一个重要的指标。当《幽灵》和《熔毁》上映时，投机性执行受到了打击。这两种攻击的本质是推测性执行具有可辨别的效果。尝试访问一些不应该被允许看到的内容，通过对缓存进行一些巧妙的定时攻击，受保护的数据会泄露给另一个进程。

Rowhammer 是一种针对机器物理内存的攻击。现代存储器只在有限的时间内保持状态，并且每秒钟需要刷新几次。事实证明，翻转附近的位会导致该状态更快地退化。Rowhammer 漏洞利用会快速翻转特定的位，以影响相邻的 ram，即使这些内存地址属于不同的进程。它可以在应该受到保护的地方更改数据。Rowhammer 的缓解措施之一是攻击过程需要了解物理内存布局。有多种技术隐藏了进程内存如何映射到物理布局，比如内核地址空间布局随机化(KASLR)。

Spoiler 是对推测性执行的一种新的滥用,它泄露了关于物理内存布局的信息，使得 Rowhammer 攻击变得更快。《纽约时报》是第一个关注这个故事的。英特尔处理器具有内存管理系统，允许推测性地执行内存加载和存储命令。研究人员意识到，在某些情况下，内存操作的延迟泄露了足够多的物理布局信息，足以进行 Rowhammer 攻击。它们展示了来自非特权用户的 Rowhammer 攻击，甚至来自 Javascript 沙箱。

## 国家安全和 Ghidra

国家安全局(NSA)对开源并不陌生，尽管这种想法可能很讽刺。他们开发并发布了安全性增强的 Linux (SELinux)和 SEAndroid。Ghidra 第一次被“宣布”是无意的，因为它在维基解密的 Vault 7 泄露中被反复提及。这是一个逆向工程工具包，支持许多架构，运行在 Linux、OSX 和 Windows 上。NSA 在 2019 年 RSA 大会上正式宣布 Ghidra 为新的开源项目。

代码还没有发布，但是二进制文件已经可用，完整的源代码将会尽快发布。美国国家安全局承诺，二进制文件不是后门。另外，在调试模式下运行 Ghidra 会向所有网络接口开放端口 18001，从而允许远程执行代码。虽然怀疑和笑话比比皆是，但 Ghidra 的质量似乎相当高，商业逆向工程工具包的价格超出了我们许多人的预算。我们期待完整源代码的发布，并利用这个新工具。

## Chromium、Windows 7 和免费后使用

释放后使用是一类内存管理漏洞。当一个程序为一个数据结构分配内存时，该内存被保留，程序使用一个指针来访问存储在那里的内容。一旦不再需要该分配，就释放内存。那么，如果程序在释放内存后试图访问它，会发生什么呢？一旦内存被释放，任何其他进程都可以被分配该内存。一旦相同的物理内存位置被释放，攻击者就可以试图分配它。当易受攻击的程序试图访问释放的内存时，它正在读取攻击者的有效载荷。

Chromium 在 file_reader_loader 例程中包含一个释放后使用错误。对单个数据结构的多个引用是无意中可用的，并且当数据被释放时，并不是所有这些引用都被删除。谷歌[已经修复了 Chromium 中的问题](http://chromium.googlesource.com/chromium/src/+/150407e8d3610ff25a45c7c46877333c4425f062%5E%21/#F0)，[发布了一份声明](http://security.googleblog.com/2019/03/disclosing-vulnerabilities-to-protect.html)，将 Chromium 漏洞与 Windows 内核漏洞联系起来。这两个问题似乎正在被主动地串联利用，以实现远程代码执行和权限提升。

谷歌采取了不同寻常的措施，建议 Windows 7 用户升级到 Windows 10，因为新版 Windows 的安全功能似乎可以防止被利用。随着对 Windows 7 的支持在 2020 年 1 月完全结束，时间的指针正慢慢走向 Windows 7 不可避免的灭亡。

看到一些我们应该报道的激动人心的安全新闻？前往[举报热线](http://hackaday.com/submit-a-tip/)告诉我们！