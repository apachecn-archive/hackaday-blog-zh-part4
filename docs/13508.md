# I2C Tap 帮助分配 SDA 冲突的责任

> 原文：<https://hackaday.com/2022/05/02/i2c-tap-helps-assign-blame-for-sda-conflicts/>

如果你曾经调试过一个行为不端的 I2C 电路，你可能知道这是多么令人沮丧。谢天谢地，Hackaday.io 的[Jim]，[有一个可电路板化的电路](https://hackaday.io/project/185109-i2c-sda-master-sda-slave-individual-monitor-out)可以帮上忙！

[内部集成电路](https://en.wikipedia.org/wiki/I%C2%B2C)总线(又名 I2C)在双线接口上使用集电极开路输出。集电极开路意味着连接到 I2C 总线的设备只能将总线拉低到地。芯片从不在导线上驱动逻辑“高”。当没有东西把线拉低时，一个弱电阻把线拉高到 VCC。这是一件好事，因为 I2C 也是一条多点总线，这意味着许多设备可以连接到总线上。如果没有集电极开路输出，一个芯片可能驱动高电平，而另一个驱动低电平，这将造成短路，可能会损坏两个器件。

即使有这些保护，还是会有问题。I2C 通信协议中的 SCL 和 SDA 线是双向的，这意味着控制器或外设都可以将其拉低。有时，当跟踪 I2C 通信时，你需要找出是哪一部分使线路处于低位。由于许多设备共享同一总线，这几乎是不可能的。有些人在电阻和模拟采样方面很有技巧，但经过实践检验的真正方法是将芯片引脚从总线上移除。

[Jim 的]电路将 SDA 信号分为控制器端和外设端，帮助您明确谁是打嗝和杂散噪声的罪魁祸首。为此，他使用 6N137 光隔离器和 LMV393 比较器。[Jim]和我们分享了一个 NapkinCAD 的示意图，在急需的时候可以复制。通过这种设计，您可以将 I2C 总线分成四个独立的通道——控制器端 SDA、外设端 SDA、组合 SDA 和 SCL。对于一个示波器来说，4 个通道可能太多了，但对于今天廉价的逻辑分析仪来说，这不成问题。

该电路额定为 100KHz 调试，但如果它对您的 400KHz(或更高)总线不起作用，您可以随时降低速度。这种监视器对于驯服失控的设备很有用，而且它在技术上并不局限于 SDA 分裂！I2C 还有一个叫时钟拉伸的功能，外设也可以操纵 SCL 线。在时钟伸展相关问题的情况下，你可以交换 SCL 和 SDA 线，这将允许你在 SCL 上使用[吉姆的]电路。

当你真的陷入棘手的 I2C 局势时，组装这样一个设备绝对不会很难。哪种？在我们的一篇长篇文章中，我们已经讨论了所有可能的 I2C 问题！