# 问 Hackaday:运算符优先级有合法的用途吗？

> 原文:[https://hack aday . com/2019/02/19/ask-hack aday-is-there-a-legit-use-for-operator-precedence/](https://hackaday.com/2019/02/19/ask-hackaday-is-there-a-legit-use-for-operator-precedence/)

计算实际上是关于秩序的。如果您可以获取数据，对其进行操作，并且每次都获得相同的结果，那么您就拥有了一个稳定可靠的计算系统。

所以运算符优先级是完全有意义的。这也称为操作顺序，它规定了哪些计算将首先执行，哪些将最后执行。为了每次都得到相同的结果，您必须按照编码顺序执行加法、乘法、幂函数、逐位数学和所有其他计算。

我最近一直在想的问题是，这对我们有影响吗，还是只对编译器有影响？

## 你会怎么做？

当我上周末敲打一些微控制器代码时，我开始查看我使用的括号的数量。我喜欢完全控制这台刻在玻璃碎片上的电脑在做什么。所以我不依赖于优先级，但这让我怀疑我是不是做错了。所以[我在 Twitter 上问](https://twitter.com/szczys/status/1094243726925402112)人们会使用下面哪一行代码:

```
a |= 1 &lt;&lt; 1 + c;
a |= 1 &lt;&lt; (1 + c);
```

不足为奇的是，每个人都抓住每一个机会拿起火炬和干草叉来支持选择父母。一致的看法是，下一个阅读代码的人会更容易理解你的意图。下一个人往往就是你——如果你不能理解自己的意图，那会多么尴尬。帮自己一个忙，用括号！

## 他不喜欢优先权，而且他写了语言！

在 C 语言中，很容易理解这些是如何构建到语法中的。等号给一个变量赋值，所以等号需要有很低的优先级，否则赋值会在运算执行之前发生。并且函数调用必须发生在任何其他操作之前，因此实际上有数据可用于操作。它工作了。在这两种情况下，我依赖于优先级，并不(一定)将等号右边的所有内容都放在括号中。但不是每个运营商都这么容易被依赖。

有趣的是，这些规则并不是在计算机语言诞生之初就出现的，而是伴随着它们发展起来的。维基百科的操作顺序文章的脚注提供了一个有趣的花絮，来自 C 语言的创始人 Dennis Ritchie，在他的书[*C 语言的发展*](https://www.bell-labs.com/usr/dmr/www/chist.html) 中:

> 今天，似乎应该移动`&`和`==`的相对优先级，从而简化一个常见的 C 习语:为了测试一个屏蔽值与另一个值的对比，必须在需要内括号但容易忘记的地方编写`if ( (a & mask) == b ) ...`。

这篇文章除了让我开怀大笑之外，还教会了我一个新名词:不恰当。

## 运算符优先级有合法的用途吗？

所以最大的问题仍然存在。如果公众舆论几乎普遍反对依赖运算符优先级，那么我们为什么要在计算机科学中教授它呢？除了基本的理解，还有其他价值吗？

信任编译器遵循你头脑中的那些看不见的规则的最合法的用途是[国际混淆 C 代码竞赛](https://www.ioccc.org/)，它目前正在开放参赛。该竞赛的目标是产生最难阅读的代码，并“以讽刺的方式展示编程风格的重要性。”

但我想知道是否有其他有趣的用途，如编写多语言代码，或编译器特定的代码。请在下面的评论中告诉我们。