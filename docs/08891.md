# ESP8266 让老式燃气表变得更加智能

> 原文:[https://hack aday . com/2021/01/31/old-gas-meter-gets-smart-with-the-esp8266/](https://hackaday.com/2021/01/31/old-gas-meter-gets-smart-with-the-esp8266/)

测量水、气或电等家用设施的使用情况通常归结为测量相对于时间的重复脉冲信号。为了方便起见，大多数现代公用事业仪表都有脉冲 LED 输出，通过使用外部光学传感器，可以用来监控消耗量。但是如果你的计价器不太配合你该怎么办？

这正是[Francesco]在开发他称之为 esp meter 的非侵入式气体跟踪系统时必须解决的问题。他的仪表可能没有发光二极管，但它有一个附着在计数器圆盘上的磁铁，可以激活内部霍尔传感器。通过一些黑客攻击，他能够附加一个外部霍尔效应传感器来拾取这个磁铁，并使用信号来监控他的日常气体消耗。

此类项目的一大绊脚石是延长设备的供电时间，以及记住什么时候该换电池的问题。通过巧妙使用常见的可用部件，他能够降低功耗，使三节 AA 电池在更换之间能够持续大约一年。首先，他使用一个 ATtiny13 来实际读取传感器值。芯片不会连续运行，其看门狗设置为 1 Hz，确保设备足够频繁地被唤醒，以便有时间为传感器供电并检测磁铁的存在。电池电压也可以通过连接到芯片 ADC 引脚的分压器来测量。

在一天中的固定时间间隔，ESP8266 轮询 ATtiny13 以获取存储的传感器脉冲和电压测量值。然后在午夜，ESP 将所有收集到的数据传输到远程服务器。总的来说，这整个方案允许[Francesco]可靠地收集他的气体消耗数据，而不必担心电池，直到他收到低电压通知。由于数据可视化需求非常基本，他通过使用 [Plotly](https://plotly.com/) 显示他的时间序列数据来保持事情的简单。

如果你不幸有一个不使用光学或磁性旋转感应的更旧的仪表，你可以使用一个[拆卸鼠标来跟踪煤气表](https://hackaday.com/2015/06/30/disassembled-mouse-keeps-track-of-gas-meter/)。