# 电路虚拟现实:先进的法尔斯塔德逻辑与 Geniac

> 原文:[https://hack aday . com/2019/08/20/circuit-VR-advanced-falstad-logic-with-geniac/](https://hackaday.com/2019/08/20/circuit-vr-advanced-falstad-logic-with-geniac/)

我发现，如果我试图向学生或同事阐述一个关于电路的观点，有时 Falstad 在线仿真器抵得上几千字。你可以画出电路，摆弄数值，甚至可以直观地看到电流，也可以进行传统的测量。模拟器不仅处理模拟电路，也处理数字电路。虽然乍一看，数字功能似乎有限，但如果你深入了解，有一个定制的逻辑块可以真正帮助你。前几天在回复一个黑客帖子时，我深入研究了这个问题，以及开关在模拟器中是如何工作的。如果你使用法尔斯塔德，请继续阅读！

## 童年记忆

[![](../Images/b68cea473df4f0aaa9a46dc770322ff5.png)](https://hackaday.com/wp-content/uploads/2019/08/brain.png) 当我还是个孩子的时候，我在 Layfayette 的产品目录上看到一款电脑的广告。这是 Geniac——最近一篇关于电脑再造的帖子的主题。我的父母支付了 20 美元，我很兴奋。毕竟，这个东西可以玩井字游戏，作曲，以及做其他神奇的事情。

问题是，我问过的人——包括我父亲工作的电力公司的一名电气工程师——没有一个能搞清楚。请记住，我可能只有 9 岁，那时候很少有人——即使是电力工程师——非常精通计算机。

当我十几岁的时候，我意识到整个事情就是一堆你可以配置成逻辑门的旋转开关。不过，到那个时候，Geniac 早就不见了，成了妈妈春季大扫除的牺牲品。几年前，我在易贝买了一个基本完整的，但它需要灯泡，我还没有更换，但它是我要做的事情清单中的一个。

## 羞耻的美德

然而，黑客日的帖子让我羞愧地采取了行动。这些年来，我还没有在手册中建立任何电路。我决定我想这样做，因为帖子里有一张二进制到十进制解码器的图片，我想也许我可以模拟一下。

[![](../Images/c5a1c0961b5bf3ec200f7701f057e9a7.png)T2】](https://hackaday.com/wp-content/uploads/2019/08/geniac_detail.png)

理解 Geniac 手册中图表的关键是您正在构建一个多路开关。因此，图中左下角的二进制 8s 数字开关是一个两位开关。二进制 4 位数字是 DPDT 开关。如果指向 0，则 7:00 和 1:00 处的触点连接。如果你指向 1:00，5:00 和 11:00 的触点会因为上盘的黄铜钉而短路。另一方面，十进制开关是一个单极，但有 16 个位置。

在操作中，你拨入你要转换的二进制数，然后转动十进制开关，直到灯泡打开。这是一个简单的开关树，每个二进制数将十进制开关的一个端子接地，由于灯泡连接到公共端，当您建立连接时，它会亮起。

## Falstad

有两个问题我必须解决。首先是在模拟器中制作多极开关。有一种方法可以做到这一点，但也有一两件事要记住。第二个问题是，我想添加一个别致的显示器，但 16:1 解码器不可用。这就是我开始使用自定义逻辑块的原因。

开关很容易弄清楚。在菜单上的无源元件下面有一个 SPDT 开关，你可以插入或者使用大写的 S 快捷键。当然，你不想要 SPDT 开关，但你必须从那里开始。一旦你在屏幕上放置了一个，你可以右击它并选择编辑。

在产生的对话框中有两个感兴趣的字段。投掷的次数很明显。对于十进制开关，您可以将其设置为 16。开关组是制造多极的关键。交换机组 0 是特殊的，意味着交换机是独立的。但是，如果您将组号设置为其他值，该组中的所有交换机将一起工作。虽然屏幕上没有直接指示，但像真正的原理图中会有。

嗯，不完全是这样。任何有一个以上电极的开关将显示为 DP，当您将鼠标悬停在它上面时。因此，同一组中具有 16 次投掷的三个开关都将显示为 DP16T，尽管这在技术上并不正确。

## 一个小陷阱

我偶然发现的另一件事是，如果你给一个开关添加一个电极，你应该确保这个开关处于默认位置，并且与同一组中的其他开关处于相同的方向。例如，如果您将 16 位开关设置到位置 5，并在位置 0 创建一个新的开关集，则开关将保持该分离。也就是说，将第一个开关移动到位置 6 会将第二个开关设置到位置 1。有时这可能是一个特性，但一般来说，这不是你想要的。真正的问题出现在开关相对的时候。那么将一个开关向上移动一个位置将会使另一个向下移动。同样，可能不是你想要的。

开关有一种方法来设置一些滑块，但这些滑块控制投掷的次数和开关的开关组，所以这不是很有用。最简单的方法可能是复制现有的开关，制作一个新的电杆。

## 自定义逻辑

有了制造像 Geniac 这样的大型开关的方法，为[十进制转换器](http://tinyurl.com/yxcm2ecr)设置开关相当容易。然而，我对此并不满意，因为开关很难辨认。法尔斯塔德并不适合 16 个开关。

[![](../Images/43636fb154e65124c30e052f39457581.png)T2】](https://hackaday.com/wp-content/uploads/2019/08/comp1.png)

我想用十进制开关的第二个极点来驱动 7 段显示器，以指示十进制开关的位置。为了做到这一点，你需要一个 16 线到 4 线的编码器，但法尔斯塔德没有我能找到的。

当然，你可以用逻辑门来构建它，但那充其量也是乏味的。但我注意到了名为自定义逻辑(在数字芯片下)的模块，这就是我一直在寻找的答案。

当你放置积木时，你会得到一个有几个输入和一个输出的小盒子。右键单击并点击 edit，您将看到一个框，让您命名用于该功能的模型。按“编辑模型”可以更改使用该模型的块的功能。

对话框中有三个定义字段。第一个是用逗号分隔的输入。您可以使用一个或两个字符名称。另一个框包含使用相同的一个或两个字符的逗号分隔的输出。该框将重新绘制以适应端口数。还有一个信息文本，当你把光标放在这个框上时就会显示出来。如果您愿意，端口名称前面也可以有一个斜杠(如/Q)来表示负逻辑。

但是，最后一个字段是您想要的字段。您可以使用简单的语法定义您的自定义函数。先举个简单的例子。假设您想要构建一个具有两个输入 A 和 b 的与门模块，输出为 c，定义如下:

```
00=0
01=0
10=0
11=1
```

就是这样。除了 1 和 0，您还可以使用+或–表示正向或负向转换。你可以用模式字母也可以用？对于一个不在乎的人。例如，假设有一个模块，如果 Enable 引脚为真，它将第一个输入(A)复制到输出。如果使能引脚为假，您希望输出零:

```
?1=A
?0=0
```

或者你可以写:

```
00=0
01=1
11=1
```

输入字符串可以比输入的数量长。在这种情况下，模拟器读取输出。这让您可以建立状态。例如，[手册](https://www.falstad.com/circuit/customlogic.html)显示了带有输入 S 和 R 的 [SR 锁存器](http://tinyurl.com/y27kqgku)可能具有输出 Q 和/Q:

```
??00=10
10??=10
01??=01
??AB=AB
```

第一行处理复位条件，因此/Q 始终等于 Q 的倒数。在定义中，您可以在左侧随意命名输出，然后在右侧使用它们，即使端口名称不同(例如，在本例中，Q 是 A，而/Q 是 B)。那句台词应该是。？XY=XY。在定义中，不能使用包括斜杠在内的两个字符。

## 最终产品

[![](../Images/1f759bb5c457d27c1d44b2d7b7fa806d.png)T2】](https://hackaday.com/wp-content/uploads/2019/08/circuit.png)

现在很容易创建解码器:

```
0000000000000001=0000
0000000000000010=0001
0000000000000100=0010
0000000000001000=0011
0000000000010000=0100
0000000000100000=0101
0000000001000000=0110
0000000010000000=0111
0000000100000000=1000
0000001000000000=1001
0000010000000000=1010
0000100000000000=1011
0001000000000000=1100
0010000000000000=1101
0100000000000000=1110
1000000000000000=1111
????????????????=0000
```

剩下的只是一大堆[布线](http://tinyurl.com/y33yfvzz)。虽然开关连接的蛇形没有 Geniac 磁盘美观，但它的作用是一样的。这将是一个很大的工作量，但是你可以用同样的方式完成所有其他的 Geniac 程序，注意每个磁盘开关有多少个投掷和极点。

实际上有比 Geniac 更好的方法来用开关进行计算。如果你想用法尔斯塔德做更多传统的逻辑模拟，[试着建造触发器](https://hackaday.com/2015/09/23/learn-flip-flops-with-simulation/)。