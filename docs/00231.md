# 引脚背后:逻辑电平输出

> 原文:[https://hack aday . com/2018/08/14/behind-the-pin-logic-level-outputs/](https://hackaday.com/2018/08/14/behind-the-pin-logic-level-outputs/)

有一样东西把硬件黑客和实验领域中常用的几乎每一台计算机和逻辑电路联系在一起。无论其年龄、速度或内部配置如何，电子设备都通过逻辑电平 I/O 与外界交流。在电压电平之间切换的单个导体表示逻辑 1 或逻辑 0。这是一个从 20 世纪 60 年代最早的集成电路逻辑输出到 2018 年最新的微控制器 GPIO，历经数十年的接口标准。

这种屡试不爽的安排的效果是，我们可以在 20 世纪 70 年代的 8 位微型计算机上使用 7400 系列 I/O 端口，并且绝对有把握地知道，它将与现代单板计算机 GPIO 轻松对接。仔细想想，这是相当惊人的。

人们很容易认为所有的逻辑电平输出都是相同的，对吗？当然，他们是从某个角度出发的。当然，您可能需要考虑 5V 和 3.3V 系列之间的电平转换，但除此之外，您只需即插即用，对吗？当然，真正的答案并不那么简单。不同逻辑和微控制器系列的 I/O 线的属性之间存在细微的电气差异。在大多数情况下，这些根本不会成为问题，但可能会成为潜在实验者需要了解的边缘情况。

## 考虑电压

[![The voltage thresholds of the various logic family inputs. From the TI Logic Guide 2017.](../Images/ee9dbdcceb4985fa777dcd020f1a6dc1.png)](https://hackaday.com/wp-content/uploads/2018/07/logic-family-voltage-table.jpg)

The voltage thresholds of the various logic family inputs. From the [TI Logic Guide 2017](http://www.ti.com/lit/sg/sdyu001ab/sdyu001ab.pdf).

这些差异最好从两个角度来看:电压和电流。[我们之前已经讨论过电平转换器](https://hackaday.com/2016/12/05/taking-it-to-another-level-making-3-3v-and-5v-logic-communicate-with-level-shifters/)的电压差问题，但还是有必要用一段简短的概述来回顾一下，因为它至少包含了一个针对粗心大意者的陷阱。我们提到过有几种不同的逻辑电压标准，其中最常见的两种是前面提到的所谓 5V 和 3.3V 系列。笼统地说，两者都将逻辑 0 识别为 0V，将逻辑 1 识别为 5v 或 3.3V，但当然这要复杂一些。

每个独立的逻辑系列都有一个电压范围，而不是一个单一的电压，它识别为一个特定的逻辑电平，感谢 TI 的市场部，我们复制了一个方便的图表来显示它们。粗心的陷阱在于两种不同类型的 5V 逻辑，所谓的 TTL 变体比它们的 CMOS 稳定器接受更宽的范围。因此，5V TTL 输入将检测来自 3.3V 输出的逻辑电平，而 CMOS 版本则不会，包括我们在内的许多工程师都被发现使用错误的芯片来连接电平，结果却发现电路不起作用。

这些变体带有“TTL”和“CMOS”标签，但令人困惑的是，这些标签指的是它们与 20 世纪 60 年代和 70 年代的原始 TTL 和 CMOS 逻辑系列的电压兼容性，而不是它们的制造。采用 CMOS 制造工艺的更新芯片通常有“TTL”和“CMOS”两种版本。例如，在 20 世纪 80 年代流行的“HC”CMOS 逻辑系列中，“TTL”版本在零件号中用“T”表示，如“74HCT00”与“74HC00”相对。

## 然后是电流

一旦克服了对电压的任何顾虑，我们就可以继续讨论电流特性了。很容易将逻辑引脚归纳为完全相同:低阻抗输出驱动高阻抗输入。典型输出应该能够轻松提供足够的电流，通过串联电阻驱动其它栅极、晶体管基极或 LED 的合理扇出。如上所述，在大多数情况下，这就是设计师需要知道的全部。但是这里面也存在一些问题。由于这些可能导致相关器件损坏的因素多种多样，因此有必要进一步探索。

[![The daddy of all TTL logic gates, the Texas Instruments 7400 quad NAND gate. Stefan506 [CC-BY-SA-3.0].](../Images/9af4eed86ca00f21f6260b94092a5dcb.png)](https://hackaday.com/wp-content/uploads/2018/07/ti_sn7400n.jpg) 

所有 TTL 逻辑门之父，德州仪器 7400 四路与非门。Stefan506 [ [CC-BY-SA-3.0](https://commons.wikimedia.org/wiki/File:TI_SN7400N.jpg) 。查看逻辑芯片或微控制器上的输出引脚时，需要记住两个电流数字。第一个是单个引脚可以提供的电流，第二个是所有引脚可以同时提供的总电流。我们再次参考 [TI 的 2017 年逻辑指南](http://www.ti.com/lit/sg/sdyu001ab/sdyu001ab.pdf) (PDF)以方便地总结众多不同分立逻辑系列的单个引脚电流，并发现了显著的变化。

此外，从历史的角度来看，TI 逻辑指南是一份有趣的文件，因为与几乎所有其他半导体产品线不同，我们发现自 20 世纪 60 年代初以来生产的几乎所有主要逻辑系列都在一起进行比较，令人难以置信的是，这些年后仍在生产。我们庆祝 NE555 或 [μA723](https://hackaday.com/2016/12/02/get-to-know-voltage-regulators-with-a-723/) 等长寿 IC，我们真的应该为 [7400 四路 2 输入与非门](http://www.ti.com/product/SN7400)做同样的事情。它于 1964 年首次推向市场，并一直持续生产，可以说它是我们当前所有数字设备和计算机发展的根源。如果没有它，我们肯定会通过不同的方式达到相同的点，但它可以被视为集成电路链中的第一环，导致了我们今天的 Core i7s 或多核 arm。

回到我们的引脚电流，翻阅逻辑指南，我们发现不同产品系列的输出电流差异很大。在大多数情况下，他们列出了普通闸门和设计有更强输出的缓冲器的数字，所以在这种情况下，我们从日常功能中选取较低的数字。

## 甚至 Hackaday 也会陷入陷阱

当然，这取决于你想用逻辑输出做什么，但是我们能建议一个试验板的坚定支持者:点亮一个 LED 吗？我们不假思索地采用经验法则，计算出一个 10mA LED 电流的串联电阻，这对于最初的 7400 的 16mA 输出来说是没问题的，但当我们发现 HC 系列的 CMOS 芯片报价为 5.2mA 时，我们感到有点震惊。即使在撰写本文的过程中，我们也发现我们对 74HC 芯片所做的一些事情可能已经超出了它的额定容量，而我们却没有意识到这一点。我们一定已经用 74HC 系列芯片点亮了试验板上的 LED 数百次，我们似乎侥幸成功的事实可能源于我们没有超过所有引脚同时提供的总电流的另一个数字。这个经验表明，假设所有的逻辑输出都是相同的，这是多么容易陷入这种陷阱，我们似乎完全是幸运地避免了面对它们并不相同的事实。

## GPIO 是保护当今更昂贵芯片的第一线

因此，在我们对 74 系列逻辑的检查中，我们得出了一个警示性的故事，但当然在大量情况下，我们在 2018 年将不会与逻辑芯片接口。相反，我们的逻辑电平输出很可能来自微控制器或单板计算机上的 GPIO 引脚。在这一点上，赌注变得明显更高，因为如果过载，我们有可能损坏一些价值不菲的东西，而不是成本低廉的逻辑芯片。因此，有必要仔细研究数据手册并听取他人的建议，以避免代价高昂的错误。

[![Who knew all this lurked behind a Raspberry Pi GPIO pin!](../Images/92ff9421cef0692b0d3c509e3ed1fdf3.png)](https://hackaday.com/wp-content/uploads/2018/08/pi-output-rethemed.jpg)

Who knew all this lurked behind a Raspberry Pi GPIO pin!

寻找一些常见电路板的信息，我们发现基于 ATmega328 的 Arduino】每个引脚有相对较大的 40 mA 裕量，但共享每个端口寄存器的 8 个引脚上的总电流为 200 mA，这有点令人困惑。与此同时，采用 3.3V 逻辑的 ESP8266 的[每个引脚的裕量为 12mA】，但出人意料的是，所有引脚都可以在该电流下同时工作。](https://bbs.espressif.com/viewtopic.php?t=139)

树莓派也有 3.3V 的逻辑电平，但有一个有趣的转折。每条 GPIO 线后没有一个驱动器，而是有一组缓冲器，可以在软件控制下切换输入和输出，[允许逐个引脚设置输出电平](https://www.scribd.com/doc/101830961/GPIO-Pads-Control2)。因此，它的最大输出可以高达 16mA，但在需要一小部分驱动能力的应用中，它可以回卷。

因此，我们探索了逻辑级输出的世界，暴露了我们陷入的一个陷阱，并最终揭示了一个流行电路板的意外特性。大体上仍然是这样的情况，当电平转换被处理时，所有的逻辑线路可以相互通信。但是我们希望现在你这样做而不释放魔法烟雾的机会减少了。