# 本周安全:代码扫描、信息收集和云中的 Seams

> 原文：<https://hackaday.com/2020/10/09/this-week-in-security-code-scanning-information-gathering-and-seams-in-the-cloud/>

GitHub [已经在公共库](https://github.blog/2020-09-30-code-scanning-is-now-available/)上启用了自由代码分析。这是一年前收购[塞姆勒的成果。任何对存储库具有写权限的人都可以进入设置，并启用扫描。除了发现漏洞的明显用例之外，一个令人兴奋的选项是自动分析拉请求并自动标记潜在的安全问题。我非常期待看到这个工具的运行。](https://github.blog/2019-09-18-github-welcomes-semmle/)

“代码扫描”选项在“安全”选项卡下，启用它的过程只需几秒钟。我打开了我的一个回购，它发现了一些值得关注的问题。重要的是，任何人都可以在分叉回购上运行该工具并查看结果。如果 CodeQL 发现了一个问题，它基本上对任何想寻找它的人都是公开的。

### 更简单的代码扫描

另一方面，[Will Butler]写了一个使用 grep 搜索漏洞的指南。举个简单的例子，如果`raw`出现在代码中，这通常意味着一个不安全的操作。在评论中经常出现的术语`fixme`或`todo`，可能预示着一个已知的尚未修复的安全问题。另一个例子是`unsafe`，它在某些语言中是一个实际的关键字，比如 Rust。如果一个 Rust 项目有漏洞，它们很可能在`unsafe`块中。还有一些其他语言相关的指针和其他好的提示，所以去看看吧。

### 在谷歌上跟踪

现实世界的攻击，至少是有针对性的攻击，涉及到对目标的大量情报收集。在脸书和谷歌这样的平台上，很多数据都是公开的，但是有时候把这些数据整合在一起是一件痛苦的事情。[mxrch]发布了[一款专门针对谷歌账户](https://github.com/mxrch/ghunt)的工具。提供一个电子邮件地址，GHunt 会尝试搜集关于该帐户的任何公开信息。

可能有什么信息？首先，它会查找该账户在其他谷歌服务上的活动。YouTube、谷歌地图和谷歌照片都是很好的信息来源。不明显的是从这些来源可以获得额外的信息。谷歌地图上共享的图片似乎已经清除了元数据，但谷歌照片上公开的图片却没有。位置数据、相机硬件和更多有趣的信息就在那里，只要你知道去哪里找。建立一个 GHunt 实例并针对您自己的 Google 帐户运行它，只是为了看看那里有什么信息，这将会很有趣。

### 新的恶意软件，旧的恶意软件

Emotet 自 2014 年以来一直存在，并被证明是一种持续给予的礼物。Ars 拥有该恶意软件的简短历史，这是一次令人印象深刻的经历。很明显，Emotet 的幕后黑手一直在开发恶意软件。最令人困惑的发展是今年早些时候的五个月，当时 Emotet 销声匿迹，结果却通过咄咄逼人的垃圾邮件卷土重来。或许连网络罪犯也为冠状病毒请假了。

一个更古老的恶意软件活动又出现了，它的出处更加清晰。FinSpy 是由 FinFisher 创建的一款商业间谍工具。大赦国际一直在报道针对政治活动家发起的间谍活动，而且他们的报告经常包括有趣的技术花絮。这一次也不例外，因为他们爆料说 [FinSpy 现在的目标是 MacOS 和 Linux 机器](https://www.amnesty.org/en/latest/research/2020/09/german-made-finspy-spyware-found-in-egypt-and-mac-and-linux-versions-revealed/)。观察到的 Linux 二进制文件被简单地命名为 PDF，这让我怀疑主要的感染机制是网络钓鱼。

### 攻击云层的缝隙

我们在[谷歌的 Project Zero 的朋友把目光](https://googleprojectzero.blogspot.com/2020/10/enter-the-vault-auth-issues-hashicorp-vault.html)放在了 HashiCorp 的 Vault 项目上([它是开源的](https://github.com/hashicorp/vault))。Vault 看起来是一个非常有用的项目，因为它处理共享数据集的数据加密。想要构建一个复杂的 web 服务，在该服务中，静态数据被正确加密，但多个用户仍然可以访问？金库也许值得一看。

天堂里并非一切都是完美的。发现安全问题的一个常见地方是服务元素之间的接口。在这种情况下，[Felix]发现了 Vault 与 AWS 认证服务接口的问题。用户可以请求访问某个对象，Vault 会将该请求转发给 Amazon 的用户验证机制。处理该响应的函数接受 XML 或 JSON 编码。事实证明，该函数也将接受包含两种编码类型的消息。诀窍是找到一种方法让 Amazon 的服务反映包含用户提供的 JSON 的认证请求。预期的响应是 XML 格式的:“是的，这个人存在”。该消息中还包含一个 JSON 欺骗响应:“此人是超级用户”。

本文中还详细介绍了另一种攻击媒介，所以如果您感兴趣，可以去获取完整的独家新闻。重点是，随着基于云的应用程序变得越来越普遍，这种漏洞也会越来越常见。与传统的计算机安全相比，这是一种不同的模式。

### 越狱的苹果电脑

越狱社区多年来一直在苹果手机硬件上打孔。桌面硬件呢？iOS 越狱用的漏洞在 MAC 上也管用吗？有几个，是的。IronPeak Services 的一名研究人员总结了针对 MacOS 机器的硬件攻击的现状。好消息是，这类攻击需要物理访问，因为易受攻击的组件具有不可变的固件，所以攻击不会持续。坏消息是不可变的固件不能打补丁，妥协所需要的只是一个 USB 设备。

今天的苹果电脑包含一个协处理器，T2。该芯片本质上是苹果移动设备的 ARM A10，处理相当多的系统功能，包括通过内置的 Secure Enclave 处理器(SEP)进行可信计算。虽然 T2 固件可以更新，但 SEP 固件是只读的，不能修改。共享的硬件也意味着共享的错误，其中一些错误存在于不可变的 SEP 固件中。即[检查 m8](https://hackaday.com/2019/10/04/this-week-in-security-is-rsa-finally-broken-the-push-for-cloud-accounts-encrypted-dns-and-more-mobile-mayhem/#checkm8) / [检查 ra1n](https://checkra.in/) 。USB 设备可以触发越狱，并启用调试模式。最终结果是对 T2 协处理器的完全根控制，以及对整个系统的相当多的控制。

对物理 USB 设备的需要意味着这不会被用于广泛的恶意攻击，但可能会对机器的所有者有用。作者声称接下来几周会有更多的消息。我们会跟踪报道，让你知道。