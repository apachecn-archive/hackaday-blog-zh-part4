# Arduino 将串行转换为并行:Paralleloslam

> 原文：<https://hackaday.com/2019/03/28/arduino-converts-serial-to-parallel-the-paralleloslam/>

在一个玩 Amigas，在学校电脑网络上惹上各种麻烦的青年时代之后，我心里一直对 80、90 年代的硬件情有独钟。这超越了计算机本身，甚至包括调制解调器、复印机，甚至备受指责的点阵打印机。

我的黑客伙伴[Cosmos2000]最近发现自己拥有一台出色的 Commodore MPS 1230 打印机。它的并行接口在当时非常合适，但是并行端口就像 SID 芯片一样稀缺。令人欣慰的是，这两个界面易于使用，功能简单。将这两个完全不同的世界结合在一起的设备的工作开始了。

## 回车:平行灯

当我在澳大利亚东海岸闲逛的时候，[Cosmos2000]正在努力工作。经过一些研究后，确定让 Arduino 将输入的串行数据转换成打印机的并行输出相对简单。在 Arduino Uno 上进行了一些测试后，一个定制的设备被制造出来——在一个华丽的塑料项目箱中。

ATMEGA328 充当操作的大脑，连接 MAX232 用于从 TTL 到 RS232 电压电平的电平转换。硬件 TX/RX 线路接收串行数据。八路数字输出充当并行接口。当通过串行接收到一个字节时，在连接到打印机并行端口的各个数字线上设置各个位。此时，选通线被拉低，向连接的设备指示它可以读取端口。两微秒后，它返回高电平，准备在输出线上设置下一个字节。这就是并行接口在没有时钟信号的情况下工作的方式，它使用选通脉冲来指示何时可以读取数据。

在这一点上，[Cosmos2000]伸出手来——问我是否有一个新的构建名称。

“Hm.Paralleloslam?”

“搞定了。干杯！”

## 让它变得有用

随着前期工作的完成和初步测试的成功，我在一个多云的星期天拜访了[Cosmos2000]。该界面在处理短文本时运行良好，但我们非常喜欢在这些速度缓慢的设备上打印照片和高质量的图形。不幸的是，不可能简单地通过串行端口输出图形数据，因为打印机跟不上，而且只有有限的缓冲区。有时以过低的波特率运行可能会比较幸运，但是点阵打印机已经够慢了。我们需要一个合适的解决方案。

![](img/66a43cafa2fa385292e5f51caecd9059.png)

【cosmos 2000】为平行四边形的原始示意图。有些功能没有实现，如波特率选择跳线。

正是因为这个原因，并行端口的特点是占线，这表明当连接的设备不能接受进一步的数据。类似地，串行接口有多种流量控制方法来处理相同的问题。我们需要从一个翻译到另一个。

我们最熟悉的是 CTS，即 Clear to Send pin，在事物的串行端。当此引脚有效时，它向主机指示所连接的设备已准备好接收更多数据。我们决定使用这种方法实现流量控制。为此，Arduino 被设置为监视打印机并行端口上的占线，每当占线不活动时，将 CTS 线设置为活动。

我们的任务明确后，接下来就是几个小时的闲荡。串行引脚一次又一次地被混淆，并且有规律地双重检查电缆以确保流量控制引脚被实际填充。最后，在极度惊愕之后，我们听到了熟悉的嗡嗡声和噼里啪啦的声音，那是我们老旧的打印机突然启动了。如果你以前从未见过两个成年人对着一个点阵欢呼雀跃，我敢打赌你没有花太多时间在 Hackaday 阅读器上。

## 表演

构建总是有很多乐趣，但我们总是喜欢测试硬件。我们花了一个下午的时间制作了一个标志，并反复印刷，然后将各种照片和图形推过机器。

速度是开发过程中的一个问题。我们以每秒 1200 和 9600 位的速度成功测试了该设备，没有出现任何问题。选通时间为 2 微秒，假设其余代码的执行时间大致相同，则最高速度可能达到每秒 250，000 字节(注意字节，因为并行代码一次输出 8 位)。这大致符合 ATMEGA328 的硬件串行端口的限制，如果配置得当，该端口每秒能够传输 200 万比特。

然而，为了可靠地达到这个速度，我怀疑需要一些代码优化。由于缺乏需要这种吞吐量的硬件，我们一直将测试保持在低端。不过，测试起来会很有趣，我认为在当前的设置下，达到每秒至少 115，200 位的串行输入并通过并行端口输出不会太难。

## 分享给大家

随着我们的成功得到确认，我们决定共享这个项目。代码已经证明对我们的目的来说足够可靠，尽管如果您的点阵处于安全关键角色，请重新考虑您的生活选择，并给我们发送一张您完成好工作的照片。不管发生什么都是你的责任。

[Github 上的资源可供您阅读](https://github.com/whatuptkhere/paralleloslam)。这不是一个像素完美，超级整洁的建设。建议使用串行接口，因为经常需要根据您碰巧使用的各种电缆和设备进行调试。然而，对于那些拥有必要知识和工具的人来说，它应该很方便。如果有人将这项工作用于其他并行设备，我们会特别感兴趣。任何以单向通信的简单字节模式接收数据的东西理论上都应该可以工作。一如既往，您的里程可能会有所不同。

来自[Cosmos2000]和我自己，我们祝你的复古硬件冒险之旅好运。

 [https://www.youtube.com/embed/dBLh1lk5htI?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/dBLh1lk5htI?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)

