# GPS 时间倒计时

> 原文:[https://hack aday . com/2019/04/05/倒计时 gps-timepocalypse/](https://hackaday.com/2019/04/05/countdown-to-the-gps-timepocalypse/)

有一个 bug 即将攻击带有 Y2K 回声的旧 GPS 硬件。那些经历过从 20 世纪 90 年代到 21 世纪初的转变的老年人，无疑会想起可怕的“2000 年错误”，这被认为是文明的末日。由于短视的软件工程只记录了两位数的年份，我们被告知，在运行从电网到数字手表等一切事物的软件中，日期计算会全部失败。进行了大规模的补救工作，公司重新雇用了那些过时技能突然又被重新需求的程序员，但最终，几乎什么都没发生。

然而，另一个时代正在到来，这个时代远不为人所知，但可能更深刻、更阴险。2019 年 4 月 6 日星期六，也就是明天，GPS 接收器可能会因时间计数器翻转而遇到软件问题。这可能会导致从小的不便到大的混乱，并有可能引发混乱。一些危言耸听者甚至声称，由于担心后果，他们不会在本周末飞行。

那么真正的潜在后果是什么，GPS 到底有什么问题？不出所料，这一切都归结为基础数学。

## 时代故事

GPS 卫星本质上是轨道上的超精确时钟，以惊人的每秒 50 比特的速度传输导航信息。导航信息包括时间戳和每颗卫星的轨道信息，下面的 GPS 接收器可以用来确定它们的位置。每条完整的导航信息有 37.5 千比特长，这意味着一整页 GPS 数据需要 12.5 分钟才能传输完。

![](../Images/023416f4462c33c4bc2ac3f87cc1a3ed.png)

Image source: [ESA Navipedia](https://gssc.esa.int/navipedia/index.php/GPS_Navigation_Message)

导航信息被分解成 1500 比特的帧，每个帧被分成五个 300 比特的子帧，每个子帧需要 6 秒来传输。每个 300 比特的子帧被进一步分成十个 30 比特的字。每个子帧的第一个 30 位字是一个遥测字，编码有关卫星健康状况的某些信息。遥测字后是一个 30 位的周时间(TOW)字，用于编码周数和该周内的时间。GPS 时间计算有点奇怪，因为在取出 13 位用于奇偶校验和其他用途后，需要将一周的秒数(604，800)编码到 TOW 字中的 17 位中。TOW 字实际上代表一周中 1.5 秒周期的数量，它被进一步除以 4，因为在每个子帧被发送所花费的 6 秒中有 4 个 1.5 秒周期。

尽管表面看来，GPS 系统空间方面的时间编码的复杂性并不是即将出现的问题的原因，尽管它是相关的。问题是 GPS 接收器如何解释时间数据，就像以前的千年虫一样，回到软件工程师做出的决定上来。在用于编码 TOW 字的 17 位中，周计数器使用 10 位。这意味着卫星可以计数到 1024 周，或者大约 19 年零 8 个月，然后计数器就会归零。现在，星期计数器都是 1:1111111111。4 月 6 日星期六，周计数器将递增，回滚到 0000000000。这就是问题所在。

## 来过这里，做过这个

这已经不是第一次发生了。自 20 世纪 70 年代末以来，GPS 系统一直以各种形式运行，起初严格用于军事用途，然后在 1983 年向民用市场开放，部分是为了回应苏联防空部队击落大韩航空公司 007 航班，声称该公司是一架间谍飞机。GPS 纪元的开始被设定为 1980 年 1 月 6 日，时间从该点向前计算。这意味着第一次翻转发生在 1999 年 8 月 21 日，也就是时钟启动后的第 1024 周。

[![](../Images/44fcb9b2d4e04769f696f8049b3e4703.png)](https://hackaday.com/wp-content/uploads/2019/04/ii-iia.jpg)

GPS II/IIa satellite image from [GPS.gov](https://www.gps.gov/multimedia/images/)

敏锐的读者会注意到，上一次 GPS 周计数器滚动时，世界并没有走到尽头，所以这一次肯定也不会发生什么事情。可能吧，但是这次有一些复杂的因素。首先，在 1999 年，平民手中只有非常非常少的 GPS 接收器。虽然麦哲伦在 1989 年推出了第一台手持 GPS 接收机 Magellan NAV 1000，一些移动电话早在 1999 年就配备了接收机，但当日期第一次翻转时，这个新生系统的任何问题都不是什么大不了的事情。

第一次翻转后的一年，美国国防部决定广播导航信息，完全启用定位精度。有史以来第一次，每个人都可以通过正确的设备获得厘米级的精度，GPS 行业开始腾飞。到 2001 年，Garmin 和 Tom Tom 开发的仪表盘导航器成为 GPS 的杀手级应用。此后不久，手机将演变成智能手机，并开始整合 GPS 接收器和导航软件。2017 年，全球 GPS 接收器市场估计接近 380 亿美元，因此有很多 GPS 接收器，远远超过 1999 年的数量。

## 回到未来？

那么，你的 GPS 设备可能会发生什么情况呢？可能没什么。GPS 制造商知道这种翻转已经有一段时间了，几乎所有过去十年制造的接收器都已经能够处理翻转。较旧的设备，比如我的古老的 Garmin eTrex Legend，它在 2003 年曾是许多家庭地理藏宝乐趣的来源，但已经在抽屉里放了多年，可能会在周六熔化。

第二个 GPS 纪元的结束将如何在特定设备上显现，完全取决于制造商如何对该东西进行编码。有些人会将这一转变解释为时间上的 19.7 年跳跃，向前或向后。导航本身不应该受到影响，即使时间不稳定，或者即使受到影响也只是一会儿。非导航 GPS 接收器，如用于同步手机服务的 GPS 时基，可能会有更多的问题，但同样，如果这些设备是最近的产品或已经打过补丁，应该不会有问题。

所以，放松下来，做你自己的事情吧，当 10 个 1 在周六的某个时候变成 10 个 0 时，基本上什么也不会发生。如果你愿意的话，你可以把你的车载 GPS 插上，看看有没有需要更新的地方，但是除此之外，你可能都很好。如果你真的想花些时间担心延期，想想这个:离我们不得不处理 2038 年的问题不到 19 年了。