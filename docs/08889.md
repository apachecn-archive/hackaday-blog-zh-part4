# 开源恒温器不会激怒你的房东

> 原文:[https://hack aday . com/2021/02/06/open-source-thermostat-wont-anger-your-landlord/](https://hackaday.com/2021/02/06/open-source-thermostat-wont-anger-your-landlord/)

[Nathan Petersen]建造了一个可破解的开源恒温器,以消除他公寓中双金属片恒温器的大滞后引起的温度波动。虽然调整“[预测器](https://inspectapedia.com/heat/Heat-Anticipator-Operation.php)来解决问题或者甚至用电子版本替换双金属恒温器可能很诱人，但从头开始构建自己的恒温器是在大学期间增加项目组合的好方法。此外，他还磨练了自己的硬件和软件设计能力。

硬件是围绕 STM32 设计的，使用廉价、最小的变体，因为该设备只需要感测温度并以开关模式控制炉子。选择 TMP117 高精度、低功耗温度传感器进行温度测量，因为精度是该项目的重要特性。熔炉的干触点输出通过常开固态继电器(光隔离器)实现。对于用户界面，不是走简单的路线和使用 I ² C/SPI 有机发光二极管或 LCD 显示器，[Nathan]使用了三个 7 段 LED 显示器，每个由 8 通道恒流驱动器驱动。其优点是可以从房间的另一端看到显示器，并且可以通过 PWM 调节亮度。温度设定点通过一个简单的滑动电位计进行调整，电位计的模拟电压由微控制器 ADC 读取。为了提醒更换电池，微控制器上的第二个 ADC 通道通过分压器监控电池电压。PCB 元件大多采用表面贴装，但所选封装易于手工焊接。

【内森】的 [Github repo](https://github.com/npetersen2/OpenThermo) 提供硬件和固件源文件。该板是在 Altium 中设计的，但使用 KiCad 的人可以使用令人敬畏的 [Altium2KiCad 转换器](https://github.com/thesourcerer8/altium2kicad)或[在线服务](http://www2.futureware.at/KiCad/)进行转换。(结果非常有用，虽然有一些小错误很容易修复。)意外的是，他的 PCB 布局第一次就非常成功，不需要任何返工或布线。

固件是数百行定制裸机 C 代码，包括与硬件外设接口的驱动程序、处理用户界面的 UI 部分以及运行熔炉的算法的控制部分。[Nathan]带我们浏览他的代码，深入研究一些控制理论和过滤基础知识。在做了一些代码调整并运行恒温器一段时间后，[Nathan]得出结论，它能够实现+0.1°F/-0.5°F 的温度调节，炉子循环持续约 10-15 分钟(即每小时 4-6 个循环)。显然，他的隔热良好的公寓和一个像样的炉子也是主要因素。接下来，对于下一个版本，[Nathan]希望通过添加一些内存和 SD 卡存储来增加数据收集功能，并使用 RTC 来允许季节性调整或基于时间的设定点。

这是他第一次尝试一个“功能性”的有用项目，但他确实喜欢制作一些偶尔出现的玩具，比如这个 [POV Top](https://hackaday.com/2018/12/29/pov-tops-hobbyist-abilities/) 。