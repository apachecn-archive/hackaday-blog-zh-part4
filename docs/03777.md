# 本周安全:VxWorks，昂贵的电子邮件欺诈，你的钱包里有什么？

> 原文:[https://hack aday . com/2019/08/02/this-week-in-security-VxWorks-贵-email-fraud-and-what-in-your-wallet/](https://hackaday.com/2019/08/02/this-week-in-security-vxworks-expensive-email-fraud-and-whats-in-your-wallet/)

这是有趣的一周。首先，Armis 的安全研究人员在 vxWorks 实时操作系统(RTOS)中发现了一系列严重的漏洞。以一个听起来像西部片或闹剧电影的名字发布。不熟悉 vxWorks？对于嵌入式设备来说，vxWorks 和 Linux 哪个更受欢迎，这还是个未知数。几个打印机品牌、Arris 调制解调器、Sonicwall 防火墙和一系列其他工业和医疗设备都运行 vxWorks RTOS。

这些漏洞中有几个是在网络堆栈中，而不是在应用程序中。最严重的是 CVE-2019-12256，这是错误处理中的一个漏洞。ICMP 错误响应由传入数据包生成，并对该传入数据包进行假设。当数据从该数据包复制到 ICMP 错误中时，不会首先检查长度，从而允许无限制的内存写入。如果这听起来很熟悉，它应该。不久前，我们报道了苹果 XNU 内核的一个类似漏洞。

即使没有打开的端口，这个特别的漏洞也能危害 vxWorks 机器。该漏洞的可取之处适用于此:恶意制作的数据包必然是畸形的，不会在公共路由中导航。也就是说，只能是局域网，不能通过互联网发送。

[![](../Images/8a4b2f74aa052727b9b37dc0d0e35dcf.png)](https://hackaday.com/wp-content/uploads/2019/08/u11-firewall_scenario-e1564371805962-1.png)

They come in through the firewall.

第二类漏洞(这个名字的来源)与 TCP 紧急指针有关。这个很少使用的 TCP 特性旨在允许更新的信息取代仍在处理的数据。TCP urgent 不仅没有被广泛使用，规范也没有写得特别好，各种 RFC 文档描述了相互冲突的实现。令人惊讶的是 vxWorks 完全支持它，但他们的实现有缺陷也就不足为奇了。对数据流的操作会导致长度整数下溢。二进制算术的性质意味着下溢无符号整数会导致它绕回最大值，这可能导致将包数据写入缓冲区中意外的存储器位置。这些漏洞需要建立 TCP 连接，但研究人员描述了攻击者可以完成的几种情况。

他们描述的最后一个 RCE 漏洞是在 DHCP 客户端中，`ipdhcpc`。这是一个非常简单的漏洞。一段代码为 DHCP 选项分配了一个缓冲区，但分配的大小比最大值少 24 个字节。攻击者可以利用这一 24 字节溢出来操纵数据结构，并可能将执行跳转到被操纵的内存中。

**更新(2019-08-02 09:15 UTC-7):**Hackaday 收到来自 SonicWall 的声明，称他们早在 7 月 19 日就为此漏洞制作了补丁:

> 确保我们客户的安全是我们 SonicWall 认真对待的责任，我们时刻保持警惕，确保我们客户的安全。运行特定版本 SonicOS 的 SonicWall 物理防火墙设备在用于远程管理的代码中包含漏洞。目前，没有迹象表明发现的漏洞正在被利用。这些补丁现在已经可用，我们强烈建议我们的合作伙伴和最终用户在 7 月 19 日立即应用 SonicOS 补丁。
> 
> [https://PS IRT . global . sonicwall . com/vuln-detail/SNWLID-2019-0009](https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2019-0009)

### 资本一:你的数据里有什么

Capital One 利用亚马逊 AWS 存储客户数据。这并不奇怪，许多公司已经转向亚马逊看似无穷无尽的云计算平台来存储大型数据集。然而，似乎 Capital One [未能在该桶](https://www.capitalone.com/facts2019/)上正确配置安全性。(正如许多其他公司所做的那样。)估计有超过 1 亿名客户的信息被泄露。一名前亚马逊员工已经被捕，并且似乎已经在 Github gist 中发布了至少一部分数据。

从字里行间来看，这似乎是一个非常简单的错误。也许凭据被泄露，或者 S3 水桶是公开的。具体细节尚未公布。第一资本对这一事件的反应值得一提。他们在 7 月 17 日被匿名告知要点的存在，使用他们负责任的披露程序。到 29 日，他们已经修复了错误配置，与执法部门协调，并公开宣布违规。12 天的周转时间是一个令人印象深刻的反应，尤其是当如此多的公司试图隐藏或忽视类似的违规行为。

### 北卡罗来纳州卡巴鲁斯县

这似乎很简单。该县新校舍的总承包商需要更新银行帐户信息。适当的表格已签署并存档，信息已更新。两个月后，承包商通知县里，他们已经错过了 250 万美元的预定付款。但交易还是通过了，钱也转到了备案的账户上。

是的，转账成功了，但是这个郡被一个社会工程骗局给毁了。该报告将其称为电子邮件帐户泄露(EAC)骗局，这似乎表明骗子首先获得了相关承包商的合法电子邮件帐户。或者，攻击者可以简单地假冒发件人的电子邮件地址，并设置不同的回复字段。除非用户特别关注这样的方案，否则很容易忽略这种差异。无论如何，即使在收回部分转移资金后，该县似乎仍亏损约 170 万美元。这些骗局越来越流行，所以记住，不要相信你在电子邮件中看到的任何东西。

### 怪异和古怪

作为本周新闻的补充，又一位[中本聪]候选人被发现:[莱纳斯·托沃兹](https://www.trustnodes.com/2019/07/27/did-linus-torvalds-invent-bitcoin)。虽然这似乎是一个严肃的建议，但我要指出的是，这篇文章没有作者的名字。他做了一个有趣的观察——git 是区块链杀手级应用。你看，我倾向于把区块链比作激光。两者都是非常聪明的发明，但是没有任何直接的用途。它们是寻找问题的解决方案。这篇文章指出区块链的核心概念存在于 git 中，这似乎是一个准确而聪明的观察。那么区块链有什么好处呢？饭桶！

本周最没用的安全新闻是什么？[当攻击者拥有无人监管的物理访问权限时，飞机上的 CAN 总线就会被利用](https://www.us-cert.gov/ics/alerts/ics-alert-19-211-01)。是的，不受监督的物理访问的人可以对飞机做坏事。想想如果他们带了扳手会做什么。