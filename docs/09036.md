# 本周安全:OpenWRT、Favicons 和隐写术

> 原文:[https://hack aday . com/2021/01/22/this-week-in-security-openwrt-favicons-and-steganographia/](https://hackaday.com/2021/01/22/this-week-in-security-openwrt-favicons-and-steganographia/)

OpenWRT 是我最喜欢的项目之一，但它度过了艰难的一周。首先，[官方 OpenWRT 论坛](https://forum.openwrt.org/)发布了一个通知，称一个管理员帐户被访问，用户列表被一个未知的恶意行为者下载。众所周知，该列表包括电子邮件地址和用户名。密码哈希似乎没有被暴露，但可以肯定的是，所有用户的密码都已过期。

[![OpenWRT Security Notice](../Images/ccca631d0b7afb8cde7b278cbac75499.png)T2】](https://hackaday.com/wp-content/uploads/2021/01/OpenWRT-Security.png)

第二个 OpenWRT 问题是[最近在 Dnsmasq](https://openwrt.org/advisory/2021-01-19-1) 中发现的一组漏洞，这个包默认安装在 OpenWRT 镜像中。在这些漏洞中，四个是缓冲区溢出，三个是如何检查 DNS 响应的弱点，这可能会导致缓存中毒。这七个漏洞统称为 [DNSpooq](https://www.jsof-tech.com/disclosures/dnspooq/) ( [白皮书 PDF](https://www.jsof-tech.com/wp-content/uploads/2021/01/DNSpooq-Technical-WP.pdf) )。

### Favicon 指纹

浏览器指纹是令人沮丧却又印象深刻的研究领域之一。你可能没有账户，可能会清空你的 cookies，但是如果一个广告商非常想跟踪你，有一系列的技术可以让这成为可能。这个列表中增加了一项新技术， [Favicon 缓存](https://www.cs.uic.edu/~polakis/papers/solomos-ndss21.pdf) (PDF)。这里的一个大问题是，favicon 缓存通常不在沙箱中，即使在匿名模式下也是如此(尽管谢天谢地没有在匿名模式下保存)，也不会与其他浏览器数据一起清除。要理解为什么这是一个问题，问一个简单的问题。确定浏览器是否有 favicon 的缓存副本有多难？

作者建议的确切方案是使用多个带有离散图标的域，每个域代表一位。然后，通过重定向链将用户发送到每个域，可以为每个用户分配不同的值。当加载收藏夹图标时，该位被设置为真。您可能想知道，服务器如何读回这些数据？客户端以只读模式处理，每个 favicon 请求都返回一个 404。通过观察进入的请求，服务器可以根据请求了哪些图标来重建唯一的标识符。

当我第一次读到这项技术时，一个潜在的第 22 条军规成为了一个问题。服务器如何知道是将新连接置于读模式还是写模式？乍一看，这似乎会挫败整个计划。favicon 指纹背后的研究人员对此有一个优雅的解决方案。单个固定域的 favicon 作为单个位标志工作，指示这是新用户还是老用户。如果浏览器请求 favicon，它是新的，可以通过标识符写入过程。如果最初的 favicon 没有被请求，那么它应该被视为回访，ID 可以被读取。总的来说，这是一种非常聪明的追踪用户的方式，特别是因为它甚至可以在匿名模式下工作。预计浏览器会很快解决这个问题。第一步将是在匿名模式下用沙盒保护缓存的图标，但是这篇论文提出了一些其他可能的解决方案。

### 轨道狐狸

WordPress 安全的长期模式是 WordPress 本身是相当防弹的，但是许多流行的插件有严重的安全问题等待被发现。本周的插件是 [Orbit Fox](https://www.wordfence.com/blog/2021/01/multiple-vulnerabilities-patched-in-orbit-fox-by-themeisle-plugin/) ，活跃安装数超过 40 万。这个插件提供了多个特性，其中一个是用户注册表单。问题是缺少表单响应的服务器端验证。在具有这种表单的站点上，只需调整响应数据，就可以将`user_role`设置为“administrator”。令人欣慰的是，这个漏洞只有在使用插件组合时才会暴露，这个问题在 12 月份被披露并修补。

### 星期二补丁

又一个补丁星期二来了又去，零日计划让我们看到了[已修复内容的概述](https://www.zerodayinitiative.com/blog/2021/1/12/the-january-2021-security-update-review)。本月有两个修补的漏洞值得注意。第一个是 CVE-2021-1647，微软 Defender 的一个缺陷。这是在野外观察到的，是 RCE 的一次利用。如果你的机器总是在线，你可能会自动得到这个补丁，因为 Windows Defender 有自己的自动更新系统。

第二个有趣的问题是 [CVE-2021-1648](https://bugs.chromium.org/p/project-zero/issues/detail?id=2096) 。此漏洞是对早期问题的错误修复的结果。来自谷歌的 Project Zero:“CVE-2020-0986 的唯一区别是，对于 CVE-2020-0986，攻击者发送了一个指针，现在攻击者发送了一个偏移量。”值得庆幸的是，这只是一个特权提升漏洞，据我们所知，现在已经被正确修复了。

### 黑客 Linux，好莱坞风格

黑客好莱坞风格偶尔也管用。你知道电影里，一个“精英黑客”在键盘上胡乱敲击，同时喋喋不休地说着关于防火墙和重新配置追踪器的废话。然而，有时[键盘敲击实际上发现了安全问题](https://github.com/linuxmint/cinnamon-screensaver/issues/354)。在这种情况下，可以通过同时在物理键盘和虚拟屏幕键盘上快速键入来解除屏幕保护锁。错误报告中的文字很精彩:“几周前，我的孩子想黑我的 linux 桌面，所以他们到处打字和点击，而我站在他们身后看他们玩……当屏保核心转储时，他们真的黑了进来！哇，那些小黑客…”

### 缩放取消遮罩

想象一下，你为邪恶集团工作。你在打电话，邪恶的总计划正在被阐明。你是一个正派的人，所以你启动了一个屏幕录像机来获得证据的副本。你已经得到了证据，现在把它送给合适的人。但首先，花点时间想想匿名。当你的录音出现在晚间新闻中时，Evilcorp 会发现是你泄露了会议内容吗？[是的，极有可能是](https://theintercept.com/2021/01/18/leak-zoom-meeting/)。

围绕音频、视频和静止图像中的识别信息的嵌入、检测和缓解，有一个完整的研究领域。这个学科被称为隐写术，有趣的是，它是以三本书的名字命名的，“隐写术”。第一本写于 1499 年的《隐写术》似乎是关于如何通过超自然的精神进行远距离交流的神秘文本。令人非常满意的是，这些书实际上是在书面文本中隐藏加密信息的指南，使用隐藏文本中描述的技术隐藏整个事情。出于我们的目的，我们可以将隐写术领域分为两大类。有意隐藏数据，无意中包含指标。

在有意数据列表的顶部是 Zoom 的水印功能。呼叫管理员可以启用这些功能，在呼叫音频和/或视频中包含唯一标识符。视频水印很容易发现，你的用户名覆盖在图像上。不能保证没有更隐蔽的水印。接下来要考虑的是元数据。特别是如果你拿出手机来录音，这个文件几乎肯定包含了时间和地点数据。当 GPS 坐标指向你的房子时，它是一个很容易识别的东西。

无意的隐写可能很简单，就像在电话顶端突出显示你的自拍摄像头一样。从录音中提取数据还有更微妙的方法，比如查看单个通话成员的延迟。如果在泄露的版本中，说话者 B 比所有其他人提前了几毫秒，那么泄密者一定在物理上靠近那个通话成员。当谈到匿名媒体时，很难涵盖所有的基础，我们在这里只是触及了表面。