# 3D 打印:管理多个打印配置文件

> 原文:[https://hack aday . com/2022/10/18/3d-printering-managing-multiple-printing-profiles/](https://hackaday.com/2022/10/18/3d-printering-managing-multiple-printing-profiles/)

我认识一些人，他们的 3D 打印机和电器没什么两样。他们买了它，用它打印，他们不改变任何东西。这不是对我的描述，我猜，也不是对你的描述。然而，当涉及到切片机时，这确实会导致一个问题。你必须不断地改变和修改配置文件。很难把事情搞清楚。例如，如果您有不同喷嘴的配置文件，您可以做出选择:保留一个配置文件并编辑更改的部分，或者保留多个配置文件，并且任何常见的更改都必须传播到其他配置文件。

![](../Images/44b8426156bc397fbba60bf53dd79eb2.png)

Part of the reason I want to manage multiple profiles has to do with this mystery object…

我早就想创建一个系统，让我拥有基线配置文件，然后只使用特定的配置文件来更改基线中的一些项目。结果，我不需要这么做。Prusa 切片器和它的叉子 SuperSlicer 已经具备了这种能力。当然，这两者都是基于 Slic3r 的，但是脚本语言是不同的，我所做的确实需要 g 代码脚本。问题是，这种能力没有被很好地记录下来，而且 GUI 并不真正直接支持它，这需要稍微回避一下。我将向您展示我是如何设置的，以及局限性在哪里。如果您想尝试一下，我强烈建议您备份您的配置目录或切换到一个新的目录。

说到这里，这两个程序都有一个`--datadir`命令行参数，可以让你把配置文件放在你想放的地方。如果你像我一样，在不同的电脑上使用切片器，这是一个很好的方法，可以将文件放在一个共享的驱动器上，或者使用 Syncthing 之类的东西来保持几个副本在网络上同步。

## 捆绑 id

预设或配置文件通常存储在格式非常简单的`.ini`文件中。每个预设的名称都放在方括号中，同时还带有该预设类型的标识符。例如，您可能有:

```
[print:myprinter]
layer_height = 0.3
```

但是这并不好，因为一个预置存在于一个文件中。当然，你可以跟踪无数的`ini`文件并动态生成它们。这是我的第一个想法。然而，切片器允许您导出和导入配置包，这些配置包一次填充一组概要文件。

从表面上看，这似乎没什么大不了的，因为您可以将一堆`ini`文件压缩到一个归档中。但是有两件事对我们有利。首先，您可以隐藏包中的某些条目。第二，您可以让一个条目从同一个包中的另一个预置继承项目。

这意味着您可以将您的配置导出为一个包，然后重新安排一切，这样您就可以在一个地方拥有所有的通用设置，然后从特定项目中继承大部分设置。例如，您可能有一个基本的 PLA 细丝类型。然后是 PLA 类型的“Brand X ”,它只覆盖几个项目。最后，您将有一个特定的“红色品牌 X PLA ”,它只需设置颜色，如果您有多个挤出机，可能还有控制颜色之间有多少细丝被清除的颜料因子。

例如:

```
[filament:PLA Brand X Red]
inherits = *PLA_Brand_X*]
filament_colour = #FF0000
filament_wipe_advanced_pigment = 0.7
```

## 隐藏条目

注意 PLA_Brand_X 标识符周围的星号吗？这告诉切片器不要向用户显示这个条目。事实上，在导入时，切片器只使用这些来填充特定项目的 ini 文件。这允许你没有一堆无意义的条目来保存你的默认值。

但是，缺点是一旦导入，预置和“基类”之间就不再有共同的联系了如果进行更改，只会更改当前的预设。不过，你可以用一些方法来解决这个问题。

因此，当我提到将您现有的配置作为一个包导出时，您将为“print:*default*”之类的内容创建新条目，以包含所有常见的内容。注意，你不希望冒号后有空格，但是不要问我为什么知道。

## 通用脚本

![](../Images/272478847230f263c39e67dab17ee9c2.png)

A hotend on a quick-change mounting plate

还有一个问题。我对此感兴趣的一个原因是，我有一个系统，可以让我快速更换酒店。有时我使用一个切换热端，有时我使用一个更传统的热端。问题是热端具有不同的挤压系数、热敏电阻校准和喷嘴尺寸。其中一些很容易用配置包来处理。然而，有一个统一的启动和关闭脚本或发送自定义代码来设置热敏电阻校准就不那么容易了。

例如，混频热端需要比普通 E3DV6 更复杂的启动。但是，两者都需要床的调整和温度的热身。我目前有六种风格的挤出机，我不想在六个不同的脚本中进行并行更改。

答案是使用脚本。不幸的是，slicer 提供的脚本语言非常有限，所以不能设置变量供以后使用。但是您可以通过阅读“占位符”(系统变量)来了解第一层的高度或所需的温度。你可能以前在启动 gcode 中见过这种用法，它可以防止你不得不为不同的材料或喷嘴尺寸使用不同的启动脚本。

但是，您也可以学习打印机预设的名称，并在其中搜索正则表达式。我利用了这一点，给每个配置文件起了我想要的名字，但是名字中出现了`!1!`或`!2!`或其他数字。这样，我可以很容易地编写代码，根据哪个概要文件正在使用它来修改参数。例如:

```
{if printer_preset=~/.*~!3!.*/ }
M305 P0 B4981
M301 E0 P22.7 I2.4 D53.8
{endif}
```

![](../Images/48c6e987c325eb69d0b9810c22b7fb88.png)

A ceramic core hotend mounted

显然，每个 hotend ID 都有相似的代码。打印机的名字看起来像:NF-！3!或者 E3D-！0!。你可能喜欢不同的角色和模式。当然，如果您愿意，您可以只搜索确切的名称，跳过数字编码。然而，这个方案允许我为同一个 hotend 拥有多个概要文件，并且仍然可以选择公共参数，而不管确切的名称。也就是 NF-！3!还有 NF-HF！3!两者都获得相同的开始和结束代码。

这些脚本的一个问题是它们都在一行上，用`\n`编码来显示换行。我解决这个问题的方法是为每个启动脚本保存一个版本控制文件。当我需要做一些改变时，我把它放入我碰巧有的任何预置中，并把它保存为一个临时名称，或者有时我只是保存它，因为我无论如何都要重写它(下面你会听到)。然后我打开相应的`.ini`文件，复制这一行放入包中。有许多其他的方法可以做到这一点。

作为一个额外的特性，每个脚本都以一个版本号和一个日期开始，所以我可以很容易地看到我所做的更改，并且我可以很容易地使用`git`返回，而不会太混乱。

## 图形用户界面断开

最后一个问题是 GUI。正如我之前提到的，导入包破坏了预置之间的关系。我发现了一些简单的规则来帮助管理疯狂。我用`git`管理包和相关文件的版本，但是这不是万灵药，因为单个文件会改变。

1.  切勿更改导入的配置文件并保存它们。当然可以，但是会让你很困惑。
2.  如果您确实更改了一个导入的概要文件，那么用一个类似的新名称保存它(我在名称中添加了-exp 来表示 experimental)。
3.  当您决定要对某个标准预设进行更改或永久添加一个预设时，请使用切片器向您展示该预设与您认为会成为良好基类的预设之间的差异。
4.  编辑包以反映您想要保留的更改。有些更改不值得保留，记得将“inherits”键设置为基类。
5.  重新导入包。删除您在步骤 2 中创建的任何额外预设。

如果您犯了任何错误，导入将会警告您。一个常见的问题是 GUI 喜欢使用大写字母，比如填充图案的名称。然而，在文件中，一切都是小写的。

一旦你做了进口，你应该没问题。需要注意的一点是,`[physical_printer]`标签有您想要设置的所有预设，因此您不必编辑物理打印机来将其与新的配置文件重新关联。

如果你真的想换工具，去看看[约书亚的] [禧年](https://hackaday.com/2019/11/14/jubilee-a-toolchanging-homage-to-3d-printer-hackers-everywhere/)。如果你没有使用兼容的切片机，你可以了解更多关于 [PrusaSlicer](https://hackaday.com/2019/05/24/3d-printering-the-past-and-future-of-prusas-slicer/) 和[超级切片机](https://hackaday.com/2021/10/26/superslicer-reviewed-another-3dp-slicer/)的信息。