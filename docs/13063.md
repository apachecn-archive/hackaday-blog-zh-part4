# 我们最喜欢的东西:二分搜索法

> 原文:[https://hack aday . com/2022/03/16/our-favorite-things-binary-search/](https://hackaday.com/2022/03/16/our-favorite-things-binary-search/)

你可能认为不可能有一个最喜欢的优化算法，但我有。如果你精通爬山的数学艺术，你可能会惊讶于我的选择甚至没有涉及到求导。这并不是说我不喜欢[牛顿法](https://en.wikipedia.org/wiki/Newton's_method)，因为我喜欢，但它只是不像[的好老二分搜索法](https://en.wikipedia.org/wiki/Binary_search_algorithm)那样广泛适用。这绝对是你工具箱里应该有的一个工具。

那些在微积分课上睡觉的人可能已经眼皮下垂了，所以我给你一个真实世界的二分搜索法的例子。假设你要在 Hackaday 上裁剪一张图片进行发布。要找到特定图像的最佳宽度，首先要选择太窄和太宽的裁剪。从边缘中间的一个初步猜测开始。如果这个第一次猜测太宽，您再次分割当前猜测和最窄宽度之间的差异。更新到这个新的猜测，你再次分裂的差异。

[![](../Images/2b579c9781a9935f9b0571ddd24502e1.png)](https://hackaday.com/wp-content/uploads/2022/03/binary_search_had.jpg) 但是让我们更具体一点:一幅 1200 像素宽的图像。它不能变得比 1200 宽，也不能变得比 0 薄。所以我们的第一个猜测是 600。那太单薄了，所以我们猜测是 900——介于 600 和上限 1200 之间。结果太宽了，所以我们下一步猜测是 750，介于 600 和 900 之间。再进行几次迭代，我们就会到达 675，然后是 638，最后是 619。在这种情况下，我们下降到像素级别相当快，我们完成了。一般来说，当你高兴的时候，或者已经达到任何精确的目标的时候，你可以停下来。

【Ed 注:我写这个的时候把数学搞砸了，很傻。但也引出了一点，当我在心里计算时，我通常会四舍五入到 50%,只要你接近，就足够好了。]

二分搜索法的奇妙之处在于它对你的要求很少。不像花哨的优化方法，你不需要任何导数。见鬼，你甚至不需要比“太少，太多”更精确地评估函数，这对于上面的金发女孩照片裁剪示例非常有帮助，但在数字世界中也非常有用。[比较器](https://www.tutorialspoint.com/linear_integrated_circuits_applications/linear_integrated_circuits_applications_comparators.htm)正是在模拟电压世界中做出这种决定，你可能已经注意到二分搜索法的“二进制”一词。但是二分搜索法不仅仅在硅内部有用。

## 为什么我打不过？

上面那个裁剪照片的例子可不是开玩笑的。我每天都要多次遵循这个程序。或者至少我试着这么做。当我在脑海中执行这样的二分搜索法时，很难训练自己每次都严格地将搜索空间*分成两半*。但我可能应该。

几周前，我和儿子正在校准一个海龟机器人。基本上，我们需要找出神奇的 PWM 百分比，使两个不同的 DC 电机以相同的速度旋转。这将是二分搜索法的一个完美应用:它稍微向左或向右转动，我们在每种情况下都有很好的边界 PWM 值。但是我们一直在说，“它只是稍微偏左了一点”，并且每次都以微小的增量提升 PWM。重复了五次之后，我很清楚我们应该使用二分搜索法。

要了解为什么你可能不应该在二进制搜索中作弊，想象一下你除了知道目标在最高值和最低值之间之外什么都不知道，但是你有这种*直觉*它更接近底部。所以你没有选择中点，而是选择了 10%。如果你是对的，你的下一个猜测将是在当前范围的 10%以内，这很棒，但如果目标只是比 10%大一点点，你将看到下一轮巨大的搜索空间。准确地说，是九倍大。你越不确定真相在哪里，你就越有可能做出错误的猜测，因为你下注的一方有更多的空间。

中点的选择不是任意的，上面的直觉可以被赋予数学严谨性(mortis)来证明当你没有额外的信息时，中点是最优的，但与此同时，我们人类难以置信地难以抵制赌博。就拿我儿子的 PWMs 来说吧——他*知道*他真的很接近了。但是他不知道*离*有多近。人类关注当前的价值。我们“[主播](https://www.pon.harvard.edu/daily/negotiation-skills-daily/what-is-anchoring-in-negotiation/)，在谈判条款。

我喜欢二分搜索法的部分原因是，这门学科有助于击败这种人类决策偏见。但是我喜欢二分搜索法的另一个原因是它很容易在硅片上实现。

## 不仅仅是生活窍门

[![](../Images/c90a766cd29f5f241e1e227e1c14b4dc.png)我最喜欢的微控制器中的模数转换器(ADC)都使用二分搜索法。他们首先假定正在数字化的电压介于`GND`和`VCC`之间。](https://hackaday.com/wp-content/uploads/2022/03/sar_had.jpg)

在内部，输入电压存储在连接到比较器的采样保持电容上。具有讽刺意味的是，比较器的另一个输入是数模转换器(DAC)的输出。该 DAC 以中点电压`VCC/2`开始，比较器显示输入是更高还是更低。

对于 10 位 DAC，可以这样做 10 次，从而得到 10 位 ADC 结果。最酷的部分是，ADC 上的二进制值不属于这个过程。第一个选择是最高有效位，依此类推。如果你想看看实际的电路，看看[Mitsuru Yamada]的基于 IC 的演示器。有关 ADC 的更多信息，[请观看 Bil Herd 的视频](https://hackaday.com/2016/05/05/analog-to-digital-conversion/)。

## 二十个问题太多了

这就是为什么二分搜索法是我最喜欢的东西之一。这是一种工具加算法，我每天都要使用多次，它是 ADC 的基础。每一步都给你带来了额外的决心，所以在现实世界中，你不太可能走超过 12 步左右。在 0 到 1，000 之间选一个数字，我试 10 次就能猜出来。

正如我的照片裁剪例子所示，你甚至不需要一个可计算的目标函数，只需要说出“更大”或“更小”的能力。如果你有一个目标函数，计算负担会特别轻。

当然，对于更复杂的优化例程来说，有一个时间和一个地方——有基于改进特定捕鼠器的整个科学分支——但是你不是在你的头脑中运行模拟退火，或者在原始硅中实现它。二分搜索法的美妙之处在于，它也是可能可行的最简单的算法，而且它对于简单的问题非常有效。解决简单的问题只会让我微笑。