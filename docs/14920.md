# 1337 年巴布亚新几内亚哈希奎尼

> 原文:[https://hackaday.com/2022/09/28/the-1337-png-hashquine/](https://hackaday.com/2022/09/28/the-1337-png-hashquine/)

hashquine 是一种展示你的加密技巧的有趣方式——它是一个包含自己散列的文件。在某些文件类型中，这很简单，你只需选择要命中的散列，然后将随机数据放入注释或其他不可见的字段中，直到发生冲突。打印自己的散列值的 Python 脚本会很容易。但并不是每个文件类型都如此简单。以巴布亚新几内亚为例。这些文件被分成数据块，每个数据块都经过 CRC-32 和 adler32 校验和检查。在三个地方同时做出一个改变，一切都会改变。祝你好运找到那个碰撞。那么[[大卫·布坎南]到底是如何生成那个漂亮的 PNG 的呢，它实际上是 MD5 求和得到图像中的值](https://twitter.com/David3141593/status/1573218394358386688/photo/1)？非常聪明。

[![md5sum hashquine.png](../Images/2eea61ee86a50e4dd9e23d0378e43ecd.png)](https://hackaday.com/wp-content/uploads/2022/09/Hashquine_demo.png) 谢天谢地[【大卫】分享了他的一些技巧](https://gist.github.com/DavidBuchanan314/a15e93eeaaad977a0fec3a6232c0b8ae)，它们相当整洁。他详述的技术是一个中间相遇黑客，其中发现 36 对 MD5 碰撞块，并理解这 36 个块将被添加到文件中。对于每个模块，该对中的 A 或 B 将在该位置插入，并且 md5sum 不会改变。这是这些块的 2^36 可能组合的总和，这比这种特殊的黑客实际需要的计算量要多。解决方案是预先计算前 18 个块的每个可能组合的结果，并将结果存储在查找表中。冲突的后一半从目标 CRC 值向后运行，并对照查找表检查结果。找到一个匹配项，您就找到了一系列与您的目标 md5sum 和 CRC32 结果都匹配的块。

感谢[朱利安]的提示！正如他所描述的那样，这种黑客技术会让你越想越印象深刻。尽情享受吧！