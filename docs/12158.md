# TFT35 双模式 3D 打印控制–动手操作

> 原文:[https://hack aday . com/2022/01/03/tft 35-双模-3d-打印-控制-动手/](https://hackaday.com/2022/01/03/tft35-dual-mode-3d-print-control-hands-on/)

我正在重新组装我的一台 3D 打印机——又一次——并决定需要升级显示器。彩色屏幕很好，但也有一些限制。我还发现有办法绕过这些限制，所以我想分享一下我对用于 3D 打印机的双模式彩色触摸屏 LCD 控制器的想法。问题中的屏幕是来自 BigTree Tech 的 TFT35。它类似于 MKS 屏幕，但是它可以在两种不同的模式下操作，正如你将看到的。

几年前，我买了一台非常便宜的 Anet A8，特别是在打折的时候。虽然不是最好的打印机，因为它有便宜的丙烯酸框架。没问题。一个装满铝挤压的箱子后来，打印机重生了。随着时间的推移，我已经完全返工挤出系统和 Y 轴，只留下电机，轴承和控制器/显示器作为原始。

最后一部分让我很困扰。Anet 板实际上对于一个小型廉价板来说是相当有能力的。但这正是打印机所需要的，仅此而已。如果你想黑掉打印机，只剩下很少的内存和一个备用的 I/O 引脚。所以是时候更换电路板了，为什么不更换控制器呢？

[![](../Images/c6914962dd0b88e57372cec975294a0c.png)](https://hackaday.com/wp-content/uploads/2021/12/classic.jpg)

The more-or-less standard display for Marlin.

A8 有一个 LCD2004。这意味着它有一个 20×4 的液晶显示器。代替编码器旋钮的是五个按钮:基本上是上、下、左、右和回车。大多数打印机现在都有一个 LCD12864，正如你可能猜到的，是一个 128×64 的 LCD，它们使用一个编码器旋钮来控制方向，你可以按下回车键。

## 一只蜘蛛出现了

我碰巧有一个这样的东西，所以当我安装新的主板时——如果你好奇的话，是 Fysetc Spider 我还连接了新的 LCD。当然，我必须重新编译 Marlin，但这很简单。一切正常，只是看起来有点乏味。

[![](../Images/b574db691bb073184a06e97f8ad09e88.png)](https://hackaday.com/wp-content/uploads/2021/12/tft35.jpg)

The TFT35 in touch mode.

还有另一种控制打印机的方法，这种方法你可能以前就想到过。由于打印机通过串行端口接受命令，你可以拿一台像 Raspberry Pi 那样的带有漂亮 LCD 的计算机，让它向串行端口发出命令。如果主板有一个以上的串行端口，那么你仍然可以连接一台运行 Octoprint 或类似功能的 PC 或 Raspberry Pi。事实证明，你不必建造这个。MKS 触摸屏使用 ARM 芯片(但不是 Pi ),并且有一个可以用来控制打印机的触摸屏。这些有不同的尺寸，通常被称为 3.5 英寸显示器的 TFT35 之类的东西。

优势不仅仅是外表。拥有一堆触摸屏按钮让许多事情变得更简单。例如，如果打印机处于(0，0)位置，而您想将打印头移动到(100，200)位置，那么在 Marlin 中就需要按很多次按钮。有了触摸显示屏，您可以调出一个导航屏幕，这很容易。或者，您可以调出整个终端并输入 g 代码。当您按下“发送”时，它会显示命令的结果(如果有)。您可以使用旋钮、屏幕按钮设置温度，或者使用虚拟键盘按下数字并输入您想要的内容。

[![](../Images/946c8aa4291762cdf2b8c27474c49c66.png)](https://hackaday.com/2022/01/03/tft35-dual-mode-3d-print-control-hands-on/move-2/)

Easy jogging with lots of buttons.

[![](../Images/081344bb6dc349a2e0b1a830618a999c.png)](https://hackaday.com/2022/01/03/tft35-dual-mode-3d-print-control-hands-on/term1/)

Send G Code from the terminal.

[![](../Images/bbbb5fbb77abf3e2f8f751659653a29d.png)](https://hackaday.com/2022/01/03/tft35-dual-mode-3d-print-control-hands-on/term2/)

The terminal displays data in pages.

## 人格分裂

这些显示器色彩鲜艳，很漂亮，但有几件事它们做不到。Marlin 有一些向导和用户交互，坚持使用合适的本地 LCD。但是马林代码认为 MKS 显示器是一台通过串行连接的远程主机。可以像两种类型的液晶显示器一样工作的显示器是一个很好的技巧，这是我以前一直不清楚的部分:这些显示器可以在打印机操作期间切换模式。换句话说，这不是选择一种模式并重新启动一切的情况。你可以看着彩色触摸屏，然后在打印时切换到股票显示，然后随时切换回来。两全其美。

从表面上看，显示器看起来像一个 MKS TFT。你有彩色菜单和触摸屏。其连接是一个简单的双线串行端口，当然还有电源、地和可选的复位连接。它们提供了一根电缆，您可以使用或修改它来连接到您的系统。还有一个 EXT3 端口，用于具有该连接器的主板。

如果你想要的只是一个 MKS 显示器，那你就完了。由于显示器看起来像主机，如果您使用的串行端口是活动的，您甚至不必重新编译 Marlin。在我的例子中，第二个串口没有设置，所以我必须重新编译，但是我经常这样做。

但是，如果您将普通的 EXT1 和 EXT2 带状电缆连接到打印机，显示器可以模拟普通的 128×64 LCD。如果您已经设置使用这些显示之一，那么您不需要重新编译 Marlin 来使用这个显示。然而，如果你设置了不同类型的显示器，你需要告诉马林使用正常的“REPRAP 折扣图形控制器”

## 营销不善

这是我对这个设备一直不理解的地方。看看亚马逊、邦古德或全球速卖通等不同供应商网站上关于它的文章，听起来你可以在任何一种模式下使用屏幕作为静态配置选择。换句话说，您可以连接 EXT1 和 EXT2，然后使用仿真模式，直到您决定在将来的某一天切换到串行模式。但事情不是这样的。您可以连接所有电缆，并在显示系统之间来回切换。

那是巨大的。这意味着您可以拥有一个漂亮的用户界面，让您控制打印机，从 SD 卡或 USB 棒打印，甚至使用 GitHub 上提供的源代码或简单的配置文件编辑来定制菜单。(是的，您可以简单地添加自定义菜单项。)但是，当您需要对 Marlin 做一些非常特殊的事情时，或者出现了 LCD 还不知道的新功能时，您可以简单地切换到 Marlin 显示模式。然后你就可以换回来了。

[![](../Images/29507cad73f656d64c9223c3d08a26bd.png)](https://hackaday.com/wp-content/uploads/2021/12/mode.jpg)

Select your mode with a touch or the encoder button.

切换的过程很简单。只要按住编码器旋钮或推动屏幕几秒钟。将出现一个屏幕，允许您选择马林模式或 BTT 模式。摸摸你想要的就行了。在 Marlin 模式下，触摸屏除了切换模式之外什么也不做，所以您可能想使用这种方法。如果在马林模式下按住编码器，打印机也会看到重复的回车键，直到液晶屏弹出选择屏幕。

如果您使用表圈，请小心。如果你把一个外壳拧紧到足以让触摸屏认为你在按屏幕，你就会卡在选择模式，这是有道理的。只是不要过度拧紧液晶显示器！

## 装置

安装液晶显示器很简单，除了一些问题。出于某种原因，EXP1 和 EXP2 的引脚 1 名称在供应商之间并不一致。Geeetech 显示器与 Spider 板配合良好，但 TFT35 根本不想进入马林模式。我在串行端口上加电，电路板出现挂起。答案是剪下带状电缆上的校准片，然后将它们翻转 180 度。

串行端口也是一个谜。几乎没有任何文档，我只是焊接了电源线和地线，然后手动缠绕 RX 和 TX，这样我就可以交换它们，直到它工作为止。正如我所料，电缆需要在这些线路交叉工作。您还必须使显示器的波特率与您使用的端口相匹配。

之后，一切顺利。EXP1 和 EXP2 连接器确实连接到电路板的 reset，因此如果您已经连接了这些连接器，则不需要连接串行端口的 reset 引脚。然而，我确实注意到，在显示器插入的情况下，将主板切换到 DFU 模式有时会失败。刷新显示器需要一个 SD 卡来刷新二进制文件，然后重新启动并加载字体和图标。如果它连接到 Spider，在更新期间尝试重新启动时，它有时会挂起。不过，它有时也会工作，所以我怀疑它只是在重置线上加载。在任何情况下，如果你不想重复尝试，弹出连接器将使它工作。

显示器有许多其他端口，但您可能不应该使用它们。例如，有一个灯丝偏转传感器端口。但是如果你把它连接在那里，只有当你在显示器上使用 SD 卡或 u 盘打印时，它才能工作。一个更好的选择是将它连接到你的打印机，并告诉马林通知主机，如果灯丝断裂发生。这将与显示器或类似 Octoprint 的东西一起工作。

理论上，你应该能够通过一个额外的串行端口连接 Octoprint 本身。然而，我从来没有得到这充分的工作。从属端口似乎工作得很好，但它从不发送 Octoprint 确认，所以 Octoprint 会一直等待，或者直到您强制它继续运行——使用终端中的假确认按钮。由于蜘蛛有多个串行端口，这不是什么大问题，但理论上，如果 TFT 可以拦截和过滤打印机和主机软件之间的数据流，它应该会工作得更好。实际上，我并没有发现任何问题。无论如何，一些 Octoprint 插件，如 DisplayLayer，可以向 TFT 发送状态信息。

## 判决

[![](../Images/4c246c5b5f9f056007c8c22b31fa8445.png)](https://hackaday.com/wp-content/uploads/2021/12/marlin.jpg)

Marlin mode is available at any time.

事实是，我不经常切换到马林模式，但如果我想要它，它也很好，你甚至可以改变颜色来适应你。我真的希望直通模式能够工作，但是如果不深入研究源代码，我就不知道发生了什么，这可能是另一个项目。

另请注意:使用 jog 键将打印机设置为相对模式。如果你习惯于在终端弹出代码，你可能要习惯于在发送移动之前发出一个 G90，因为 TFT 会在你慢跑时将它改变为相对。

这些显示器价格低廉，易于接口，因为它们仍然可以作为经典显示器工作，没有理由不进行这种简单的升级。当然，您可以打印大量的安装选项。最终的结果看起来很棒，使用新的显示器可以更容易地在 X 和 Y 方向移动。