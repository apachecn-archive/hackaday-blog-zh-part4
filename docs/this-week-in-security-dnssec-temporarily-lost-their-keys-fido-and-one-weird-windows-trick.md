# 本周安全:DNSSEC 暂时失去了他们的钥匙，FIDO，和一个奇怪的窗口技巧

> 原文：<https://hackaday.com/2020/02/21/this-week-in-security-dnssec-temporarily-lost-their-keys-fido-and-one-weird-windows-trick/>

DNSSEC 是允许加密安全 DNS 的系统。它完全基于一个根密钥，由互联网号码分配机构(IANA)维护。想知道根密钥签名密钥存储在哪里，以及如何访问它吗？每年举行四次仪式，从物理保险箱中拔出根钥匙，并在一群见证人面前执行维护任务。

这样的活动原定于 2 月 12 日举行，但是发现了一个小问题。存放密钥媒体的一个保险箱的锁坏了，在进行修复时，有几天无法使用根密钥签名密钥。IANA 的开放性意味着他们的大部分行动都被公开报道，你甚至可以观看最终在 2 月 16 日举行的[关键签约仪式](https://www.iana.org/dnssec/ceremonies/40)。

### OpenSSH 增加了 FIDO 支持

OpenSSH 的 8.2 版本刚刚发布，虽然它包含了正常的错误修复和改进，但突出的特性是支持 FIDO/U2F 双因素身份验证设备。

U2F，Universal 2nd Factor，是身份验证设备的开放标准，如 Yubikey 或 Google 的 Titan key。在 SSH 中支持它是一个巨大的安全胜利。这里有一个问题需要注意:U2F 协议使用挑战-响应方案，其中挑战首先被发送到硬件令牌，然后硬件令牌生成响应。这种方案非常安全，但是在 SSH 的一个典型用例中不会自动运行。您可以使用 U2F 从本地机器连接到远程主机，将您的令牌插入本地 USB 端口。如果您需要从该远程主机 SSH 到另一台机器，问题就出现了——远程认证过程不再有与本地 USB 设备交互的路径。这听起来可能令人费解，但这种情况对我们许多人来说很常见。

在这些情况下，OpenSSH 似乎不会自动代理 U2F 身份验证，但是有一个实用程序 PAM_SSH_AGENT_AUTH 可以自动代理。

### 声波墙

如果说我们从过去几个月的安全新闻中学到了什么，那就是即使是生产安全相关产品的大公司也不能幸免于安全问题。这是老生常谈的最新提醒吗？[声波墙](https://blog.scrt.ch/2020/02/11/sonicwall-sra-and-sma-vulnerabilties/)。[Alain Mowat]查看了他们的安全远程访问产品的试用版，他下载了该产品的虚拟机映像。他发现了一个普通的 SQL 注入攻击和一个有趣的缓冲区溢出。该溢出存在于解析传入 HTTP 连接的[用户代理字符串](https://webaim.org/blog/user-agent-string-history/)的代码中。在 Safari 浏览器中，会创建一个 11 个字符的缓冲区，并将用户代理文本复制到下一个空格字符。不做进一步的检查，导致轻微的缓冲区溢出和危害。

[Alain]报告了他的发现，Sonicwall 发布了建议和修正。在补丁发布几个月后，他做了部分网页扫描，测试他发现的第三个小问题，一个目录横向漏洞。在发现多个设备仍然存在易受攻击的迹象后，他选择不发布任何漏洞代码。

### V4L2

Linux 内核的视频捕获驱动程序 V4L2 有一个与视频流分解期间互斥锁相关的错误。互斥体，或者互斥对象，只不过是一个用来管理哪个线程正在使用内存位置的标志。两个线程同时写入同一个缓冲区不可避免地会破坏数据，因此在每个线程操作数据时，使用互斥体来“锁定”数据。

问题在于互斥锁发布得太早，有点幼稚。攻击者可以赢得竞争条件，并将缓冲区指针推入 V4L2 队列。该指针指向现在释放的内存，这意味着有可能在那里分配一个恶意对象，并在流再次启动时执行代码。[亚历山大·波波夫]向我们展示了整个利用过程，值得一读。

由于漏洞具体在 vivid 驱动中，而且 Linux 内核不允许非 root 用户加载内核模块，所以这里的攻击面非常小。它在 2019 年底被修复，但仍然是一个值得学习的内核漏洞利用的好例子。

### 这个奇怪的窗户把戏

Windows 用户组策略是限制用户帐户访问计算机的方法之一，例如禁止访问任务管理器。[大卫·威尔斯]给我们带来了他发现的一个漂亮的小旁路。(他还负责 clickbait 标题。)

它归结为默认的 Windows 行为，即在用户的配置文件文件夹中检查“ntuser.man”。该文件位置旨在用于强制配置文件，即应用于所有用户的设置。但是，如果该文件不是由管理员创建的，则用户可以写该配置文件文件夹。那么，需要做些改变来允许一些额外的特权吗？将它们写到丢失的文件中，注销，然后重新登录。Windows 将找到该文件，并像处理福音一样处理它。

### 加密股份公司

本周摆在办公桌上的重大新闻是关于 Crypto AG，一家总部位于瑞士的加密公司。它是由[鲍里斯·哈格林]创建的，他是一名密码学家，在二战期间为美军制造了一种替代恩尼格玛机的机器 M-209，从而一举成名。战后，他搬回瑞典创办了自己的公司。1951 年，与 AFSA(后来重组为美国国家安全局)的威廉·弗里德曼(William Friedman)达成握手协议，意味着 Crypto AG 只向获得批准的国家出售他们最先进的产品。

1970 年，中央情报局和西德 BND 合作，秘密从[哈格林]手中购买了 Crypto AG。在美国国家安全局的协助下，他们向全球许多政府提供易受攻击的加密机器，然后利用他们的知识解密这些机器产生的流量。这个不可思议的计划至少持续到 20 世纪 90 年代末，可能晚至 2018 年，听起来像是直接出自冷战小说。