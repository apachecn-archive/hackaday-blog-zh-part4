# 本周安全:鸭嘴兽、Git.bat、TCL 电视和在线游戏的教训

> 原文：<https://hackaday.com/2020/11/13/this-week-in-security-platypus-git-bat-tcl-tvs-and-lessons-from-online-gaming/>

Git 的大文件系统是解决一个小问题的合理方案。如何处理需要进入 git 存储库的大型二进制文件？它可能是作为项目文档一部分的图片或视频，甚至是演示数据集。Git-lfs 的解决方案是用基于文本的指针替换二进制文件，该指针指向实际文件所在的位置。不过，这对[理解这个漏洞](https://legalhackers.com/advisories/Git-LFS-RCE-Exploit-CVE-2020-27955.html)并不重要。问题是`git-lfs`将调用主 git 二进制文件作为其操作的一部分，当它这样做时，完整路径没有被使用。在 Unix 系统上，这不是问题。`$PATH`变量用于确定在哪里寻找二进制文件。当 git 运行时，`/usr/bin/git`自动运行。然而，在 Windows 系统上，执行不带路径的二进制名称将首先在当前目录中查找，如果没有找到匹配的可执行文件，则只检查标准位置。

你可能已经看出问题了。如果存储库包含 Windows 认为可执行的`git.exe`、`git.bat`或另一个`git.*`文件，`git-lfs`将执行该文件，而不是预期的 git 二进制文件。这意味着简单地检查一个恶意的存储库就可以立即执行代码。默认情况下，2.29.2.2 之前的标准 git for Windows 安装包含易受攻击的插件，所以请检查您是否已更新！

那么请记住，这种脆弱性还有一个问题。在运行下一个 git 命令之前，您对 git 下载内容的检查有多仔细？即使是打了补丁的`git-lfs`版本，如果您克隆了一个恶意的存储库，然后运行任何其他 git 命令，您仍然会运行本地的`git.*`文件。真正的解决方案是将本地目录推到路径链的更高处。

## 英特尔的鸭嘴兽

![PLATYPUS logo](img/93a936d60fadf5b446bedd41251cfefc.png)英特尔在他们的处理器中有一个新的有趣的漏洞修复，[鸭嘴兽](https://platypusattack.com/)。已经发布了一系列操作系统更新、固件版本，甚至微码补丁来处理这个新问题。我们可以看看[白皮书(PDF)](https://platypusattack.com/platypus.pdf) 然后决定，鸭嘴兽到底有多严重？

鸭嘴兽中心的机制是英特尔的 RAPL，运行平均功率限制接口。简单来说，就是英特尔 CPU 的实时功率表。在 Linux 内核中，该接口暴露给了没有特权的用户。现在，一个没有特权的用户可以用这样的功率计做什么呢？

显然，其中一个演示攻击能够在大约 20 秒内绘制出随机的 Linux 内核地址空间。从特权(根级别)攻击位置，可以发现英特尔 SGX 飞地中的秘密。怎么会？这和二战时期的暴风雨本质上是同一个问题。任何泄露加密设备内部状态信息的东西都可以用来攻击加密技术。在这种情况下，它不是无线电发射，而是以电力使用形式的信息发射。这个故事中还有一些其他聪明的元素，比如将一个单独的 bug 滥用到单步处理器函数中，让攻击者在数据收集中获得更好的分辨率。很可能在接下来的几个月里，我们会看到关于鸭嘴兽攻击再次被使用 AMD 芯片，甚至可能是 ARM 处理器的新闻。

## TCL 电视

有一句古老的格言，永远不要把可以用简单的疏忽来解释的事情归咎于恶意。目前还不清楚[某些 TCL 电视](https://sick.codes/extraordinary-vulnerabilities-discovered-in-tcl-android-tvs-now-worlds-3rd-largest-tv-manufacturer/)出现的【病码】和【约翰·杰克逊】问题是否完全可以用疏忽来解释。在我们推测之前，让我们先看看实际发现了什么。首先，目标系统是一系列运行 Android 的 TCL 品牌智能电视。像我们许多人一样，[病态代码]从 NMAP 扫描开始，寻找开放的端口。

十四岁。有 14 个开放端口，不是标准服务，而是半随机的高级端口。其中大多数运行 HTTP/HTTPS 服务，这些服务可能是某种 API 连接。他们发现的最有趣的端口是 7978，在那里整个根文件系统都可用。那个被分配到 CVE 2020-27403。第二个漏洞 CVE-2020-28055 是一个文件夹权限问题。TCL 供应商文件夹是全球可写的，这意味着其他应用程序可以在那里注入代码。

我设法与[病态代码]本人谈论了这个问题，他指出一个名为`TerminalManager_Remote`的应用程序特别有趣。它似乎是 TR-069 协议的定制实现，该协议旨在用于 ISP 硬件的远程管理。智能电视使用该协议的确切原因尚不清楚。人们可以推测有多少信息被捕获并发送回 TCL。至少，我们可以说，根据我们对该单元上运行的软件的了解，存在滥用行为的可能性。

这个故事有足够多有趣的元素，我已经订购了一台 TCL 电视，并计划自己在这个主题上做一些工作。留意更新，可能会有更多的简历。

## 在线游戏和安全性

我发现了福克斯主教(Bishop Fox)的(Dan Petro)的三篇精彩文章。他研究了在线游戏世界中的欺骗问题，以及哪些反欺骗措施有效，哪些无效，然后将学到的经验应用于 web 应用程序安全。他做出了和我们的许多读者一样的观察，游戏行业有一种奇怪的爱用间谍软件来防止作弊。

第一条是关于隐藏的信息，以及游戏中实际执行规则的地方。如果整个游戏地图被发送到客户端，那么不可避免的是，一个骗子可以向玩家展示整个地图。类似地，如果客户端被信任来执行游戏逻辑，那么客户端作弊可以很容易地修改该逻辑。显而易见的应用是不要相信运行在用户硬件上的任何东西。在现代浏览器上打开 web 控制台，仔细查看发送到浏览器的每一点信息，实在是太容易了。不要相信客户。

第二部分是关于检测和禁止僵尸程序。Aim 机器人和宏是游戏世界的两大问题。检测这些问题的首选方法是通过“异常检测”。某个游戏玩家是否过快地执行了过多的完美输入？他们有几乎不可能的精确度吗？你可能认识到与谷歌 reCAPTCHA 程序的相似之处。在这两种情况下，系统都在寻找一个“信号”，一个用户不完全是人类的信号。

最后一集是关于比赛条件的。这个例子是一个经历网络延迟的玩家如何在地图上传送，并且不可能被击中。一些不道德的玩家甚至安装了一个“延迟开关”来故意触发这种行为。解决方案是使用像互斥和强制同步规则这样的技术来保证预期的行为。总的来说，这些文章是对安全哲学的一种意想不到的理解，但是读起来很有趣。

## 也是现成的

本周早些时候，阿尔·威廉姆斯报道了《以太化》。这是一个聪明的黑客技术，它使用一个以太网端口作为临时传输天线。

Bryan Cockfield 写了一个针对 Ubuntu 的巧妙攻击,用户可以破坏系统服务，欺骗系统再次运行首次启动用户创建对话框，允许本地权限升级。